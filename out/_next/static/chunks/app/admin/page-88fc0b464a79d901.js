(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3],{9474:function(e,s,t){Promise.resolve().then(t.bind(t,7140))},7140:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return q}});var a=t(7437),l=t(8730),r=t(5974),i=t(2339),n=t(9205);let c=(0,n.Z)("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);var d=t(1723),x=t(5805);let o=(0,n.Z)("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),m=(0,n.Z)("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);var h=t(9376),u=t(6484),j=t(9116),v=t(6070),p=t(3774),g=t(2369),f=t(525),N=t(1047);let y=(0,n.Z)("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]),w=(0,n.Z)("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);function b(){let{data:e,isLoading:s}=(0,u.useQuery)("activity-stats",async()=>(await j.hi.get("/admin/activity-stats")).data);if(s)return(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,a.jsxs)(v.Zb,{children:[(0,a.jsxs)(v.Ol,{className:"animate-pulse",children:[(0,a.jsx)("div",{className:"h-6 bg-gray-200 rounded w-1/2"}),(0,a.jsx)("div",{className:"h-4 bg-gray-200 rounded w-3/4"})]}),(0,a.jsx)(v.aY,{children:(0,a.jsx)("div",{className:"h-64 bg-gray-200 rounded animate-pulse"})})]}),(0,a.jsxs)(v.Zb,{children:[(0,a.jsxs)(v.Ol,{className:"animate-pulse",children:[(0,a.jsx)("div",{className:"h-6 bg-gray-200 rounded w-1/2"}),(0,a.jsx)("div",{className:"h-4 bg-gray-200 rounded w-3/4"})]}),(0,a.jsx)(v.aY,{children:(0,a.jsx)("div",{className:"h-64 bg-gray-200 rounded animate-pulse"})})]})]});let t=(null==e?void 0:e.dailyActivity)||[],l=t.reduce((e,s)=>({users:e.users+s.users,propertyReviews:e.propertyReviews+s.propertyReviews,tenantReviews:e.tenantReviews+s.tenantReviews}),{users:0,propertyReviews:0,tenantReviews:0}),r=Math.max(...t.map(e=>Math.max(e.users,e.propertyReviews,e.tenantReviews)));return 0===t.length?(0,a.jsxs)(v.Zb,{children:[(0,a.jsx)(v.Ol,{children:(0,a.jsxs)(v.ll,{className:"flex items-center",children:[(0,a.jsx)(y,{className:"h-5 w-5 mr-2"}),"Дневная активность"]})}),(0,a.jsx)(v.aY,{children:(0,a.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,a.jsx)(y,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),(0,a.jsx)("p",{children:"Нет доступных данных об активности"})]})})]}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,a.jsxs)(v.Zb,{children:[(0,a.jsxs)(v.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(v.ll,{className:"text-sm font-medium",children:"Регистрации пользователей за 30 дней"}),(0,a.jsx)(x.Z,{className:"h-4 w-4 text-blue-600"})]}),(0,a.jsxs)(v.aY,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:l.users}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:["В среднем ",Math.round(l.users/30)," в день"]})]})]}),(0,a.jsxs)(v.Zb,{children:[(0,a.jsxs)(v.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(v.ll,{className:"text-sm font-medium",children:"Отзывы о недвижимости за 30 дней"}),(0,a.jsx)(w,{className:"h-4 w-4 text-green-600"})]}),(0,a.jsxs)(v.aY,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:l.propertyReviews}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:["В среднем ",Math.round(l.propertyReviews/30)," в день"]})]})]}),(0,a.jsxs)(v.Zb,{children:[(0,a.jsxs)(v.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(v.ll,{className:"text-sm font-medium",children:"Отзывы о жильцах за 30 дней"}),(0,a.jsx)(w,{className:"h-4 w-4 text-purple-600"})]}),(0,a.jsxs)(v.aY,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:l.tenantReviews}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:["В среднем ",Math.round(l.tenantReviews/30)," в день"]})]})]})]}),(0,a.jsxs)(v.Zb,{children:[(0,a.jsxs)(v.Ol,{children:[(0,a.jsxs)(v.ll,{className:"flex items-center",children:[(0,a.jsx)(y,{className:"h-5 w-5 mr-2"}),"Дневная активность (последние 30 дней)"]}),(0,a.jsx)(v.SZ,{children:"Регистрации пользователей и публикация отзывов по дням"})]}),(0,a.jsx)(v.aY,{children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex flex-wrap gap-6 text-sm",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"w-3 h-3 bg-blue-500 rounded mr-2"}),(0,a.jsx)("span",{children:"Пользователи"})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"w-3 h-3 bg-green-500 rounded mr-2"}),(0,a.jsx)("span",{children:"Отзывы о недвижимости"})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"w-3 h-3 bg-purple-500 rounded mr-2"}),(0,a.jsx)("span",{children:"Отзывы о жильцах"})]})]}),(0,a.jsx)("div",{className:"h-64 flex items-end justify-between space-x-1 bg-gray-50 p-4 rounded-lg overflow-x-auto",children:t.map((e,s)=>(0,a.jsxs)("div",{className:"flex flex-col items-center space-y-1 min-w-0 flex-1",children:[(0,a.jsxs)("div",{className:"flex items-end space-x-0.5 h-48",children:[(0,a.jsx)("div",{className:"bg-blue-500 rounded-t w-2 transition-all duration-300 hover:bg-blue-600",style:{height:r>0?"".concat(e.users/r*100,"%"):"0%"},title:"".concat(e.users," пользователей")}),(0,a.jsx)("div",{className:"bg-green-500 rounded-t w-2 transition-all duration-300 hover:bg-green-600",style:{height:r>0?"".concat(e.propertyReviews/r*100,"%"):"0%"},title:"".concat(e.propertyReviews," отзывов о недвижимости")}),(0,a.jsx)("div",{className:"bg-purple-500 rounded-t w-2 transition-all duration-300 hover:bg-purple-600",style:{height:r>0?"".concat(e.tenantReviews/r*100,"%"):"0%"},title:"".concat(e.tenantReviews," отзывов о жильцах")})]}),(0,a.jsx)("div",{className:"text-xs text-gray-500 transform -rotate-45 origin-top-left whitespace-nowrap",children:new Date(e.date).toLocaleDateString("ru-RU",{month:"short",day:"numeric"})})]},e.date))}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-6",children:[(0,a.jsx)("div",{className:"bg-blue-50 p-4 rounded-lg",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-blue-900",children:"День пика регистраций пользователей"}),(0,a.jsx)("p",{className:"text-xs text-blue-700",children:t.length>0?new Date(t.reduce((e,s)=>s.users>e.users?s:e).date).toLocaleDateString("ru-RU",{year:"numeric",month:"short",day:"numeric"}):"Н/Д"})]}),(0,a.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:t.length>0?Math.max(...t.map(e=>e.users)):0})]})}),(0,a.jsx)("div",{className:"bg-green-50 p-4 rounded-lg",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-green-900",children:"День пика отзывов"}),(0,a.jsx)("p",{className:"text-xs text-green-700",children:t.length>0?new Date(t.reduce((e,s)=>s.propertyReviews+s.tenantReviews>e.propertyReviews+e.tenantReviews?s:e).date).toLocaleDateString("ru-RU",{year:"numeric",month:"short",day:"numeric"}):"Н/Д"})]}),(0,a.jsx)("div",{className:"text-2xl font-bold text-green-600",children:t.length>0?Math.max(...t.map(e=>e.propertyReviews+e.tenantReviews)):0})]})})]})]})})]})]})}var Z=t(44);function R(){var e,s;let{data:t,isLoading:l}=(0,u.useQuery)("city-stats",async()=>(await j.hi.get("/admin/city-stats")).data);if(l)return(0,a.jsx)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:(0,a.jsxs)(v.Zb,{children:[(0,a.jsxs)(v.Ol,{className:"animate-pulse",children:[(0,a.jsx)("div",{className:"h-6 bg-gray-200 rounded w-1/2"}),(0,a.jsx)("div",{className:"h-4 bg-gray-200 rounded w-3/4"})]}),(0,a.jsx)(v.aY,{children:(0,a.jsx)("div",{className:"space-y-4",children:[void 0,void 0,void 0,void 0,void 0].map((e,s)=>(0,a.jsx)("div",{className:"h-12 bg-gray-200 rounded animate-pulse"},s))})})]})});let i=(null==t?void 0:t.cities)||[],n=i.slice(0,10),c=i.reduce((e,s)=>e+s.totalReviews,0),d=i.length;return 0===i.length?(0,a.jsxs)(v.Zb,{children:[(0,a.jsx)(v.Ol,{children:(0,a.jsxs)(v.ll,{className:"flex items-center",children:[(0,a.jsx)(p.Z,{className:"h-5 w-5 mr-2"}),"Статистика по городам"]})}),(0,a.jsx)(v.aY,{children:(0,a.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,a.jsx)(p.Z,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),(0,a.jsx)("p",{children:"Нет данных по городам"})]})})]}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[(0,a.jsxs)(v.Zb,{children:[(0,a.jsxs)(v.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(v.ll,{className:"text-sm font-medium",children:"Всего городов"}),(0,a.jsx)(p.Z,{className:"h-4 w-4 text-blue-600"})]}),(0,a.jsxs)(v.aY,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:d}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"С отзывами"})]})]}),(0,a.jsxs)(v.Zb,{children:[(0,a.jsxs)(v.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(v.ll,{className:"text-sm font-medium",children:"Всего отзывов"}),(0,a.jsx)(Z.Z,{className:"h-4 w-4 text-green-600"})]}),(0,a.jsxs)(v.aY,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:c.toLocaleString()}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Во всех городах"})]})]}),(0,a.jsxs)(v.Zb,{children:[(0,a.jsxs)(v.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(v.ll,{className:"text-sm font-medium",children:"Среднее на город"}),(0,a.jsx)(f.Z,{className:"h-4 w-4 text-purple-600"})]}),(0,a.jsxs)(v.aY,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:d>0?Math.round(c/d):0}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Отзывов на город"})]})]}),(0,a.jsxs)(v.Zb,{children:[(0,a.jsxs)(v.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(v.ll,{className:"text-sm font-medium",children:"Топ город"}),(0,a.jsx)(x.Z,{className:"h-4 w-4 text-orange-600"})]}),(0,a.jsxs)(v.aY,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:(null===(e=n[0])||void 0===e?void 0:e.totalReviews)||0}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:(null===(s=n[0])||void 0===s?void 0:s.city)||"Н/Д"})]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,a.jsxs)(v.Zb,{children:[(0,a.jsxs)(v.Ol,{children:[(0,a.jsxs)(v.ll,{className:"flex items-center",children:[(0,a.jsx)(p.Z,{className:"h-5 w-5 mr-2"}),"Топ городов по количеству отзывов"]}),(0,a.jsx)(v.SZ,{children:"Города с наибольшим количеством отзывов о недвижимости и жильцах"})]}),(0,a.jsx)(v.aY,{children:(0,a.jsx)("div",{className:"space-y-4",children:n.map((e,s)=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"flex items-center justify-center w-8 h-8 bg-blue-100 text-blue-600 rounded-full text-sm font-semibold",children:s+1}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium",children:e.city}),(0,a.jsxs)("div",{className:"flex items-center space-x-2 text-sm text-gray-600",children:[(0,a.jsxs)("span",{children:[e.propertyReviews," недвижимости"]}),(0,a.jsx)("span",{children:"•"}),(0,a.jsxs)("span",{children:[e.tenantReviews," жильцов"]})]})]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("p",{className:"font-semibold",children:e.totalReviews}),(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsxs)("span",{className:"text-sm text-gray-600",children:["★ ",e.averageRating]}),e.growth>0&&(0,a.jsxs)(r.C,{variant:"secondary",className:"text-xs bg-green-100 text-green-700",children:["+",e.growth,"%"]})]})]})]},e.city))})})]}),(0,a.jsxs)(v.Zb,{children:[(0,a.jsxs)(v.Ol,{children:[(0,a.jsxs)(v.ll,{className:"flex items-center",children:[(0,a.jsx)(f.Z,{className:"h-5 w-5 mr-2"}),"Тренды роста по городам"]}),(0,a.jsx)(v.SZ,{children:"Города с самым быстрым ростом активности по отзывам"})]}),(0,a.jsx)(v.aY,{children:(0,a.jsxs)("div",{className:"space-y-4",children:[n.filter(e=>e.growth>0).sort((e,s)=>s.growth-e.growth).slice(0,8).map((e,s)=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 bg-green-50 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"flex items-center justify-center w-8 h-8 bg-green-100 text-green-600 rounded-full text-sm font-semibold",children:s+1}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium",children:e.city}),(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:[e.totalReviews," всего отзывов"]})]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)(r.C,{className:"bg-green-100 text-green-700",children:["+",e.growth,"%"]}),(0,a.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:["★ ",e.averageRating]})]})]},e.city)),0===n.filter(e=>e.growth>0).length&&(0,a.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,a.jsx)(f.Z,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),(0,a.jsx)("p",{children:"Нет данных о росте"})]})]})})]})]}),(0,a.jsxs)(v.Zb,{children:[(0,a.jsxs)(v.Ol,{children:[(0,a.jsxs)(v.ll,{className:"flex items-center",children:[(0,a.jsx)(Z.Z,{className:"h-5 w-5 mr-2"}),"Распределение отзывов"]}),(0,a.jsx)(v.SZ,{children:"Отзывы о недвижимости и жильцах по топ городам"})]}),(0,a.jsx)(v.aY,{children:(0,a.jsx)("div",{className:"space-y-4",children:n.slice(0,8).map(e=>{let s=e.totalReviews>0?Math.round(e.propertyReviews/e.totalReviews*100):0,t=100-s;return(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"font-medium",children:e.city}),(0,a.jsxs)("span",{className:"text-sm text-gray-600",children:[e.totalReviews," отзывов"]})]}),(0,a.jsxs)("div",{className:"flex h-2 bg-gray-200 rounded-full overflow-hidden",children:[(0,a.jsx)("div",{className:"bg-blue-500 transition-all duration-300",style:{width:"".concat(s,"%")},title:"".concat(e.propertyReviews," отзывов о недвижимости (").concat(s,"%)")}),(0,a.jsx)("div",{className:"bg-purple-500 transition-all duration-300",style:{width:"".concat(t,"%")},title:"".concat(e.tenantReviews," отзывов о жильцах (").concat(t,"%)")})]}),(0,a.jsxs)("div",{className:"flex justify-between text-xs text-gray-600",children:[(0,a.jsxs)("span",{children:["Недвижимость: ",e.propertyReviews," (",s,"%)"]}),(0,a.jsxs)("span",{children:["Жильцы: ",e.tenantReviews," (",t,"%)"]})]})]},e.city)})})})]})]})}let k=(0,n.Z)("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),C=(0,n.Z)("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);function P(){var e,s;let{data:t,isLoading:l}=(0,u.useQuery)("user-growth",async()=>(await j.hi.get("/admin/user-growth")).data);if(l)return(0,a.jsx)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:(0,a.jsxs)(v.Zb,{children:[(0,a.jsxs)(v.Ol,{className:"animate-pulse",children:[(0,a.jsx)("div",{className:"h-6 bg-gray-200 rounded w-1/2"}),(0,a.jsx)("div",{className:"h-4 bg-gray-200 rounded w-3/4"})]}),(0,a.jsx)(v.aY,{children:(0,a.jsx)("div",{className:"h-64 bg-gray-200 rounded animate-pulse"})})]})});let i=(null==t?void 0:t.monthlyGrowth)||[];if(0===i.length)return(0,a.jsxs)(v.Zb,{children:[(0,a.jsx)(v.Ol,{children:(0,a.jsxs)(v.ll,{className:"flex items-center",children:[(0,a.jsx)(f.Z,{className:"h-5 w-5 mr-2"}),"Рост пользователей"]})}),(0,a.jsx)(v.aY,{children:(0,a.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,a.jsx)(x.Z,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),(0,a.jsx)("p",{children:"Нет данных о росте"})]})})]});let n=i[i.length-1],c=i[i.length-2],d=c&&c.newUsers>0?Math.round((n.newUsers-c.newUsers)/c.newUsers*100):0,o=Math.max(...i.map(e=>e.totalUsers)),m=Math.max(...i.map(e=>e.newUsers));return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[(0,a.jsxs)(v.Zb,{children:[(0,a.jsxs)(v.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(v.ll,{className:"text-sm font-medium",children:"Всего пользователей"}),(0,a.jsx)(x.Z,{className:"h-4 w-4 text-blue-600"})]}),(0,a.jsxs)(v.aY,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:(null==n?void 0:null===(e=n.totalUsers)||void 0===e?void 0:e.toLocaleString())||0}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:["+",(null==n?void 0:n.newUsers)||0," за этот месяц"]})]})]}),(0,a.jsxs)(v.Zb,{children:[(0,a.jsxs)(v.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(v.ll,{className:"text-sm font-medium",children:"Месячный рост"}),(0,a.jsx)(f.Z,{className:"h-4 w-4 text-green-600"})]}),(0,a.jsxs)(v.aY,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:(null==n?void 0:n.newUsers)||0}),(0,a.jsx)("div",{className:"flex items-center",children:(0,a.jsxs)(r.C,{variant:d>=0?"default":"destructive",className:"text-xs",children:[d>=0?"+":"",d,"%"]})})]})]}),(0,a.jsxs)(v.Zb,{children:[(0,a.jsxs)(v.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(v.ll,{className:"text-sm font-medium",children:"Активные пользователи"}),(0,a.jsx)(k,{className:"h-4 w-4 text-purple-600"})]}),(0,a.jsxs)(v.aY,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:(null==n?void 0:null===(s=n.activeUsers)||void 0===s?void 0:s.toLocaleString())||0}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:[(null==n?void 0:n.totalUsers)>0?Math.round((null==n?void 0:n.activeUsers)/(null==n?void 0:n.totalUsers)*100):0,"% от общего числа"]})]})]}),(0,a.jsxs)(v.Zb,{children:[(0,a.jsxs)(v.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(v.ll,{className:"text-sm font-medium",children:"Коэффициент удержания"}),(0,a.jsx)(C,{className:"h-4 w-4 text-orange-600"})]}),(0,a.jsxs)(v.aY,{children:[(0,a.jsxs)("div",{className:"text-2xl font-bold",children:[(null==n?void 0:n.retentionRate)||0,"%"]}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Месячное удержание"})]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,a.jsxs)(v.Zb,{children:[(0,a.jsxs)(v.Ol,{children:[(0,a.jsxs)(v.ll,{className:"flex items-center",children:[(0,a.jsx)(f.Z,{className:"h-5 w-5 mr-2"}),"Динамика роста пользователей"]}),(0,a.jsx)(v.SZ,{children:"Общее количество пользователей и новых регистраций по месяцам"})]}),(0,a.jsx)(v.aY,{children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex gap-6 text-sm",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"w-3 h-3 bg-blue-500 rounded mr-2"}),(0,a.jsx)("span",{children:"Всего пользователей"})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"w-3 h-3 bg-green-500 rounded mr-2"}),(0,a.jsx)("span",{children:"Новые пользователи"})]})]}),(0,a.jsx)("div",{className:"h-64 flex items-end justify-between space-x-1 bg-gray-50 p-4 rounded-lg",children:i.map((e,s)=>(0,a.jsxs)("div",{className:"flex flex-col items-center space-y-1 min-w-0 flex-1",children:[(0,a.jsxs)("div",{className:"flex items-end space-x-0.5 h-48",children:[(0,a.jsx)("div",{className:"bg-blue-500 rounded-t w-1 transition-all duration-300 hover:bg-blue-600",style:{height:o>0?"".concat(e.totalUsers/o*100,"%"):"0%"},title:"".concat(e.totalUsers," всего пользователей")}),(0,a.jsx)("div",{className:"bg-green-500 rounded-t w-3 transition-all duration-300 hover:bg-green-600",style:{height:m>0?"".concat(e.newUsers/m*100,"%"):"0%"},title:"".concat(e.newUsers," новых пользователей")})]}),(0,a.jsx)("div",{className:"text-xs text-gray-500 transform -rotate-45 origin-top-left whitespace-nowrap",children:e.month})]},e.month))})]})})]}),(0,a.jsxs)(v.Zb,{children:[(0,a.jsxs)(v.Ol,{children:[(0,a.jsxs)(v.ll,{className:"flex items-center",children:[(0,a.jsx)(x.Z,{className:"h-5 w-5 mr-2"}),"Метрики вовлеченности пользователей"]}),(0,a.jsx)(v.SZ,{children:"Активные пользователи и коэффициенты удержания"})]}),(0,a.jsx)(v.aY,{children:(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-sm font-medium mb-3",children:"Активные пользователи по месяцам"}),(0,a.jsx)("div",{className:"space-y-2",children:i.slice(-6).map(e=>{let s=e.totalUsers>0?Math.round(e.activeUsers/e.totalUsers*100):0;return(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-sm text-gray-600 w-16",children:e.month}),(0,a.jsx)("div",{className:"flex-1 mx-3",children:(0,a.jsx)("div",{className:"bg-gray-200 rounded-full h-2",children:(0,a.jsx)("div",{className:"bg-purple-500 h-2 rounded-full transition-all duration-300",style:{width:"".concat(s,"%")}})})}),(0,a.jsx)("span",{className:"text-sm font-medium w-16 text-right",children:e.activeUsers.toLocaleString()})]},e.month)})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-sm font-medium mb-3",children:"Месячный коэффициент удержания"}),(0,a.jsx)("div",{className:"space-y-2",children:i.slice(-6).map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-sm text-gray-600 w-16",children:e.month}),(0,a.jsx)("div",{className:"flex-1 mx-3",children:(0,a.jsx)("div",{className:"bg-gray-200 rounded-full h-2",children:(0,a.jsx)("div",{className:"bg-orange-500 h-2 rounded-full transition-all duration-300",style:{width:"".concat(e.retentionRate,"%")}})})}),(0,a.jsxs)("span",{className:"text-sm font-medium w-16 text-right",children:[e.retentionRate,"%"]})]},e.month))})]})]})})]})]}),(0,a.jsxs)(v.Zb,{children:[(0,a.jsxs)(v.Ol,{children:[(0,a.jsxs)(v.ll,{className:"flex items-center",children:[(0,a.jsx)(N.Z,{className:"h-5 w-5 mr-2"}),"Инсайты по росту"]}),(0,a.jsx)(v.SZ,{children:"Ключевые метрики и анализ трендов"})]}),(0,a.jsx)(v.aY,{children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,a.jsx)("div",{className:"bg-blue-50 p-4 rounded-lg",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-blue-900",children:"Лучший месяц по росту"}),(0,a.jsx)("p",{className:"text-xs text-blue-700",children:i.length>0?i.reduce((e,s)=>s.newUsers>e.newUsers?s:e).month:"Н/Д"})]}),(0,a.jsxs)("div",{className:"text-2xl font-bold text-blue-600",children:["+",i.length>0?Math.max(...i.map(e=>e.newUsers)):0]})]})}),(0,a.jsx)("div",{className:"bg-green-50 p-4 rounded-lg",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-green-900",children:"Средний месячный рост"}),(0,a.jsx)("p",{className:"text-xs text-green-700",children:"Последние 6 месяцев"})]}),(0,a.jsx)("div",{className:"text-2xl font-bold text-green-600",children:i.length>=6?Math.round(i.slice(-6).reduce((e,s)=>e+s.newUsers,0)/6):0})]})}),(0,a.jsx)("div",{className:"bg-purple-50 p-4 rounded-lg",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-purple-900",children:"Самое высокое удержание"}),(0,a.jsx)("p",{className:"text-xs text-purple-700",children:i.length>0?i.reduce((e,s)=>s.retentionRate>e.retentionRate?s:e).month:"Н/Д"})]}),(0,a.jsxs)("div",{className:"text-2xl font-bold text-purple-600",children:[i.length>0?Math.max(...i.map(e=>e.retentionRate)):0,"%"]})]})}),(0,a.jsx)("div",{className:"bg-orange-50 p-4 rounded-lg",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-orange-900",children:"Темп роста"}),(0,a.jsx)("p",{className:"text-xs text-orange-700",children:"Месяц к месяцу"})]}),(0,a.jsxs)("div",{className:"text-2xl font-bold text-orange-600",children:[d>=0?"+":"",d,"%"]})]})})]})})]})]})}function S(){var e,s,t,l,r,n,m,h,y,w,Z,k,C,S,U,_,Y,M,O,z,A;let{data:L,isLoading:Q}=(0,u.useQuery)("admin-stats",async()=>(await j.hi.get("/admin/stats")).data);if(Q)return(0,a.jsx)("div",{className:"space-y-6",children:(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[...Array(8)].map((e,s)=>(0,a.jsx)(v.Zb,{children:(0,a.jsxs)(v.Ol,{className:"animate-pulse",children:[(0,a.jsx)("div",{className:"h-4 bg-gray-200 rounded w-3/4"}),(0,a.jsx)("div",{className:"h-8 bg-gray-200 rounded w-1/2"})]})},s))})});let D=[{title:"Всего пользователей",value:(null==L?void 0:null===(e=L.users)||void 0===e?void 0:e.total)||0,description:"+".concat((null==L?void 0:null===(s=L.users)||void 0===s?void 0:s.daily)||0," сегодня"),icon:x.Z,color:"text-blue-600",change:(null==L?void 0:null===(t=L.users)||void 0===t?void 0:t.weeklyGrowth)||0},{title:"Отзывы о недвижимости",value:(null==L?void 0:null===(l=L.propertyReviews)||void 0===l?void 0:l.total)||0,description:"+".concat((null==L?void 0:null===(r=L.propertyReviews)||void 0===r?void 0:r.daily)||0," сегодня"),icon:p.Z,color:"text-green-600",change:(null==L?void 0:null===(n=L.propertyReviews)||void 0===n?void 0:n.weeklyGrowth)||0},{title:"Отзывы о жильцах",value:(null==L?void 0:null===(m=L.tenantReviews)||void 0===m?void 0:m.total)||0,description:"+".concat((null==L?void 0:null===(h=L.tenantReviews)||void 0===h?void 0:h.daily)||0," сегодня"),icon:g.Z,color:"text-purple-600",change:(null==L?void 0:null===(y=L.tenantReviews)||void 0===y?void 0:y.weeklyGrowth)||0},{title:"Ожидают модерации",value:((null==L?void 0:null===(w=L.propertyReviews)||void 0===w?void 0:w.pending)||0)+((null==L?void 0:null===(Z=L.tenantReviews)||void 0===Z?void 0:Z.pending)||0),description:"Ожидают модерации",icon:d.Z,color:"text-yellow-600",change:0}];return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 lg:gap-6",children:D.map((e,s)=>{let t=e.icon;return(0,a.jsxs)(v.Zb,{children:[(0,a.jsxs)(v.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(v.ll,{className:"text-sm font-medium",children:e.title}),(0,a.jsx)(t,{className:"h-4 w-4 ".concat(e.color)})]}),(0,a.jsxs)(v.aY,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:e.value.toLocaleString()}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:e.description}),0!==e.change&&(0,a.jsxs)("div",{className:"flex items-center text-xs ".concat(e.change>0?"text-green-600":"text-red-600"),children:[(0,a.jsx)(f.Z,{className:"h-3 w-3 mr-1 ".concat(e.change<0?"rotate-180":"")}),Math.abs(e.change),"%"]})]})]})]},s)})}),(0,a.jsxs)(i.mQ,{defaultValue:"overview",className:"space-y-4",children:[(0,a.jsxs)(i.dr,{className:"grid w-full grid-cols-2 lg:grid-cols-4",children:[(0,a.jsx)(i.SP,{value:"overview",children:"Обзор"}),(0,a.jsx)(i.SP,{value:"activity",children:"Активность"}),(0,a.jsx)(i.SP,{value:"geography",children:"География"}),(0,a.jsx)(i.SP,{value:"growth",children:"Рост"})]}),(0,a.jsxs)(i.nU,{value:"overview",className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,a.jsxs)(v.Zb,{children:[(0,a.jsx)(v.Ol,{children:(0,a.jsxs)(v.ll,{className:"flex items-center text-lg",children:[(0,a.jsx)(N.Z,{className:"h-5 w-5 mr-2 text-blue-600"}),"Статистика за неделю"]})}),(0,a.jsxs)(v.aY,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-sm text-gray-600",children:"Новых пользователей"}),(0,a.jsx)("span",{className:"font-semibold",children:(null==L?void 0:null===(k=L.users)||void 0===k?void 0:k.weekly)||0})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-sm text-gray-600",children:"Отзывов о недвижимости"}),(0,a.jsx)("span",{className:"font-semibold",children:(null==L?void 0:null===(C=L.propertyReviews)||void 0===C?void 0:C.weekly)||0})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-sm text-gray-600",children:"Отзывов о жильцах"}),(0,a.jsx)("span",{className:"font-semibold",children:(null==L?void 0:null===(S=L.tenantReviews)||void 0===S?void 0:S.weekly)||0})]})]})]}),(0,a.jsxs)(v.Zb,{children:[(0,a.jsx)(v.Ol,{children:(0,a.jsxs)(v.ll,{className:"flex items-center text-lg",children:[(0,a.jsx)(N.Z,{className:"h-5 w-5 mr-2 text-green-600"}),"Статистика за месяц"]})}),(0,a.jsxs)(v.aY,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-sm text-gray-600",children:"Новых пользователей"}),(0,a.jsx)("span",{className:"font-semibold",children:(null==L?void 0:null===(U=L.users)||void 0===U?void 0:U.monthly)||0})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-sm text-gray-600",children:"Отзывов о недвижимости"}),(0,a.jsx)("span",{className:"font-semibold",children:(null==L?void 0:null===(_=L.propertyReviews)||void 0===_?void 0:_.monthly)||0})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-sm text-gray-600",children:"Отзывов о жильцах"}),(0,a.jsx)("span",{className:"font-semibold",children:(null==L?void 0:null===(Y=L.tenantReviews)||void 0===Y?void 0:Y.monthly)||0})]})]})]}),(0,a.jsxs)(v.Zb,{children:[(0,a.jsx)(v.Ol,{children:(0,a.jsxs)(v.ll,{className:"flex items-center text-lg",children:[(0,a.jsx)(o,{className:"h-5 w-5 mr-2 text-red-600"}),"Очередь на модерацию"]})}),(0,a.jsxs)(v.aY,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-sm text-gray-600",children:"Недвижимость в ожидании"}),(0,a.jsx)("span",{className:"font-semibold",children:(null==L?void 0:null===(M=L.propertyReviews)||void 0===M?void 0:M.pending)||0})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-sm text-gray-600",children:"Жильцы в ожидании"}),(0,a.jsx)("span",{className:"font-semibold",children:(null==L?void 0:null===(O=L.tenantReviews)||void 0===O?void 0:O.pending)||0})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-sm text-gray-600",children:"Жалобы на контент"}),(0,a.jsx)("span",{className:"font-semibold text-red-600",children:((null==L?void 0:null===(z=L.propertyReviews)||void 0===z?void 0:z.reported)||0)+((null==L?void 0:null===(A=L.tenantReviews)||void 0===A?void 0:A.reported)||0)})]})]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,a.jsxs)(v.Zb,{children:[(0,a.jsx)(v.Ol,{children:(0,a.jsxs)(v.ll,{className:"flex items-center",children:[(0,a.jsx)(c,{className:"h-5 w-5 mr-2"}),"Оценки отзывов о недвижимости"]})}),(0,a.jsx)(v.aY,{children:(0,a.jsx)("div",{className:"space-y-3",children:[5,4,3,2,1].map(e=>{var s,t,l;let r=(null==L?void 0:null===(t=L.propertyReviews)||void 0===t?void 0:null===(s=t.ratingDistribution)||void 0===s?void 0:s[e])||0,i=Math.round(r/((null==L?void 0:null===(l=L.propertyReviews)||void 0===l?void 0:l.total)||1)*100);return(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsxs)("span",{className:"text-sm font-medium w-8",children:[e,"★"]}),(0,a.jsx)("div",{className:"flex-1 bg-gray-200 rounded-full h-2",children:(0,a.jsx)("div",{className:"bg-yellow-500 h-2 rounded-full transition-all duration-300",style:{width:"".concat(i,"%")}})}),(0,a.jsx)("span",{className:"text-sm text-gray-600 w-12",children:r}),(0,a.jsxs)("span",{className:"text-sm text-gray-500 w-10",children:[i,"%"]})]},e)})})})]}),(0,a.jsxs)(v.Zb,{children:[(0,a.jsx)(v.Ol,{children:(0,a.jsxs)(v.ll,{className:"flex items-center",children:[(0,a.jsx)(c,{className:"h-5 w-5 mr-2"}),"Оценки отзывов о жильцах"]})}),(0,a.jsx)(v.aY,{children:(0,a.jsx)("div",{className:"space-y-3",children:[5,4,3,2,1].map(e=>{var s,t,l;let r=(null==L?void 0:null===(t=L.tenantReviews)||void 0===t?void 0:null===(s=t.ratingDistribution)||void 0===s?void 0:s[e])||0,i=Math.round(r/((null==L?void 0:null===(l=L.tenantReviews)||void 0===l?void 0:l.total)||1)*100);return(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsxs)("span",{className:"text-sm font-medium w-8",children:[e,"★"]}),(0,a.jsx)("div",{className:"flex-1 bg-gray-200 rounded-full h-2",children:(0,a.jsx)("div",{className:"bg-yellow-500 h-2 rounded-full transition-all duration-300",style:{width:"".concat(i,"%")}})}),(0,a.jsx)("span",{className:"text-sm text-gray-600 w-12",children:r}),(0,a.jsxs)("span",{className:"text-sm text-gray-500 w-10",children:[i,"%"]})]},e)})})})]})]})]}),(0,a.jsx)(i.nU,{value:"activity",children:(0,a.jsx)(b,{})}),(0,a.jsx)(i.nU,{value:"geography",children:(0,a.jsx)(R,{})}),(0,a.jsx)(i.nU,{value:"growth",children:(0,a.jsx)(P,{})})]})]})}var U=t(2265),_=t(2869),Y=t(401),M=t(2489),O=t(9064);function z(){let e=(0,u.useQueryClient)(),[s,t]=(0,U.useState)({}),{data:l,isLoading:n}=(0,u.useQuery)("pending-reviews",async()=>(await j.hi.get("/admin/pending-reviews")).data),c=(0,u.useMutation)(async e=>{let{id:s,action:t}=e;await j.hi.patch("/admin/property-reviews/".concat(s,"/moderate"),{action:t})},{onSuccess:()=>{e.invalidateQueries("pending-reviews"),e.invalidateQueries("admin-stats"),O.ZP.success("Отзыв успешно модерирован")},onError:()=>{O.ZP.error("Не удалось модерировать отзыв")}}),x=(0,u.useMutation)(async e=>{let{id:s,action:t}=e;await j.hi.patch("/admin/tenant-reviews/".concat(s,"/moderate"),{action:t})},{onSuccess:()=>{e.invalidateQueries("pending-reviews"),e.invalidateQueries("admin-stats"),O.ZP.success("Отзыв успешно модерирован")},onError:()=>{O.ZP.error("Не удалось модерировать отзыв")}}),o=async(e,s,a)=>{t(t=>({...t,["".concat(e,"-").concat(s)]:!0}));try{"property"===a?await c.mutateAsync({id:e,action:s}):await x.mutateAsync({id:e,action:s})}finally{t(t=>({...t,["".concat(e,"-").concat(s)]:!1}))}};if(n)return(0,a.jsxs)(v.Zb,{children:[(0,a.jsx)(v.Ol,{children:(0,a.jsx)(v.ll,{children:"Загрузка ожидающих отзывов..."})}),(0,a.jsx)(v.aY,{children:(0,a.jsx)("div",{className:"animate-pulse space-y-4",children:[void 0,void 0,void 0].map((e,s)=>(0,a.jsx)("div",{className:"h-24 bg-gray-200 rounded"},s))})})]});let m=(null==l?void 0:l.propertyReviews)||[],h=(null==l?void 0:l.tenantReviews)||[],f=m.length+h.length;return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)(v.Zb,{children:(0,a.jsxs)(v.Ol,{children:[(0,a.jsxs)(v.ll,{className:"flex items-center",children:[(0,a.jsx)(d.Z,{className:"h-5 w-5 mr-2"}),"Ожидающие отзывы (",f,")"]}),(0,a.jsx)(v.SZ,{children:"Отзывы, ожидающие одобрения модерации"})]})}),0===f?(0,a.jsx)(v.Zb,{children:(0,a.jsxs)(v.aY,{className:"text-center py-8",children:[(0,a.jsx)(d.Z,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),(0,a.jsx)("p",{className:"text-gray-500",children:"Нет ожидающих отзывов"})]})}):(0,a.jsxs)(i.mQ,{defaultValue:"property",className:"space-y-4",children:[(0,a.jsxs)(i.dr,{className:"grid w-full grid-cols-2",children:[(0,a.jsxs)(i.SP,{value:"property",className:"flex items-center gap-2",children:[(0,a.jsx)(p.Z,{className:"h-4 w-4"}),"Недвижимость (",m.length,")"]}),(0,a.jsxs)(i.SP,{value:"tenant",className:"flex items-center gap-2",children:[(0,a.jsx)(g.Z,{className:"h-4 w-4"}),"Арендатор (",h.length,")"]})]}),(0,a.jsx)(i.nU,{value:"property",className:"space-y-4",children:0===m.length?(0,a.jsx)(v.Zb,{children:(0,a.jsx)(v.aY,{className:"text-center py-8",children:(0,a.jsx)("p",{className:"text-gray-500",children:"Нет ожидающих отзывов о недвижимости"})})}):m.map(e=>(console.log(e),(0,a.jsxs)(v.Zb,{children:[(0,a.jsx)(v.Ol,{children:(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(v.ll,{className:"flex items-center text-lg",children:[(0,a.jsx)(p.Z,{className:"h-5 w-5 mr-2 text-blue-600"}),e.street," ",e.building,", ",e.city]}),(0,a.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,a.jsxs)(r.C,{variant:"secondary",children:[e.numberOfRooms," комн."]}),(0,a.jsxs)("span",{className:"text-sm text-gray-600",children:["от ",e.author.firstName," ",e.author.lastName]})]})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(_.z,{size:"sm",onClick:()=>o(e._id,"approve","property"),disabled:s["".concat(e._id,"-approve")],className:"bg-green-600 hover:bg-green-700",children:[(0,a.jsx)(Y.Z,{className:"h-4 w-4 mr-1"}),s["".concat(e._id,"-approve")]?"...":"Одобрить"]}),(0,a.jsxs)(_.z,{size:"sm",variant:"destructive",onClick:()=>o(e._id,"reject","property"),disabled:s["".concat(e._id,"-reject")],children:[(0,a.jsx)(M.Z,{className:"h-4 w-4 mr-1"}),s["".concat(e._id,"-reject")]?"...":"Отклонить"]})]})]})}),(0,a.jsx)(v.aY,{children:(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center text-sm text-gray-600",children:[(0,a.jsx)(N.Z,{className:"h-4 w-4 mr-2"}),"Аренда: ",e.rentalPeriod.from.month,"/",e.rentalPeriod.from.year," -"," ",e.rentalPeriod.to.month,"/",e.rentalPeriod.to.year]}),(0,a.jsxs)("div",{className:"flex items-center text-sm text-gray-600",children:["Номер квартиры: ",e.building]}),(0,a.jsxs)("div",{className:"text-sm",children:[(0,a.jsx)("span",{className:"font-medium",children:"Арендодатель:"})," ",e.landlordName]}),(0,a.jsx)("p",{className:"text-gray-700",children:e.reviewText}),(0,a.jsxs)("div",{className:"text-xs text-gray-500",children:["Отправлено:"," ",new Date(e.createdAt).toLocaleString("ru-RU")]})]})})]},e._id)))}),(0,a.jsx)(i.nU,{value:"tenant",className:"space-y-4",children:0===h.length?(0,a.jsx)(v.Zb,{children:(0,a.jsx)(v.aY,{className:"text-center py-8",children:(0,a.jsx)("p",{className:"text-gray-500",children:"Нет ожидающих отзывов об арендаторах"})})}):h.map(e=>(0,a.jsxs)(v.Zb,{children:[(0,a.jsx)(v.Ol,{children:(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(v.ll,{className:"flex items-center text-lg",children:[(0,a.jsx)(g.Z,{className:"h-5 w-5 mr-2 text-green-600"}),e.tenantFullName]}),(0,a.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,a.jsxs)(r.C,{variant:"secondary",children:["ИНН: ***",e.tenantIdLastFour]}),(0,a.jsxs)(r.C,{variant:"secondary",children:["Телефон: ***",e.tenantPhoneLastFour]}),(0,a.jsxs)("span",{className:"text-sm text-gray-600",children:["от ",e.author.firstName," ",e.author.lastName]})]})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(_.z,{size:"sm",onClick:()=>o(e._id,"approve","tenant"),disabled:s["".concat(e._id,"-approve")],className:"bg-green-600 hover:bg-green-700",children:[(0,a.jsx)(Y.Z,{className:"h-4 w-4 mr-1"}),s["".concat(e._id,"-approve")]?"...":"Одобрить"]}),(0,a.jsxs)(_.z,{size:"sm",variant:"destructive",onClick:()=>o(e._id,"reject","tenant"),disabled:s["".concat(e._id,"-reject")],children:[(0,a.jsx)(M.Z,{className:"h-4 w-4 mr-1"}),s["".concat(e._id,"-reject")]?"...":"Отклонить"]})]})]})}),(0,a.jsx)(v.aY,{children:(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center text-sm text-gray-600",children:[(0,a.jsx)(N.Z,{className:"h-4 w-4 mr-2"}),"Аренда: ",e.rentalPeriod.from.month,"/",e.rentalPeriod.from.year," -"," ",e.rentalPeriod.to.month,"/",e.rentalPeriod.to.year]}),(0,a.jsx)("p",{className:"text-gray-700 break-words whitespace-pre-line",children:e.reviewText}),(0,a.jsxs)("div",{className:"text-xs text-gray-500",children:["Отправлено:"," ",new Date(e.createdAt).toLocaleString("ru-RU")]})]})})]},e._id))})]})]})}var A=t(5186),L=t(3247);let Q=(0,n.Z)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]),D=(0,n.Z)("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]),I=(0,n.Z)("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]);function V(){let e=(0,u.useQueryClient)(),[s,t]=(0,U.useState)(""),[l,i]=(0,U.useState)({}),{data:n,isLoading:c}=(0,u.useQuery)("admin-users",async()=>(await j.hi.get("/admin/users")).data),d=(0,u.useMutation)(async e=>{let{userId:s,isActive:t}=e;await j.hi.patch("/admin/users/".concat(s,"/status"),{isActive:t})},{onSuccess:()=>{e.invalidateQueries("admin-users"),O.ZP.success("Статус пользователя успешно обновлён")},onError:()=>{O.ZP.error("Не удалось обновить статус пользователя")}}),o=async(e,s)=>{i(s=>({...s,[e]:!0}));try{await d.mutateAsync({userId:e,isActive:!s})}finally{i(s=>({...s,[e]:!1}))}},m=(null==n?void 0:n.filter(e=>e.firstName.toLowerCase().includes(s.toLowerCase())||e.lastName.toLowerCase().includes(s.toLowerCase())||e.email.toLowerCase().includes(s.toLowerCase())))||[];return c?(0,a.jsxs)(v.Zb,{children:[(0,a.jsx)(v.Ol,{children:(0,a.jsx)(v.ll,{children:"Загрузка пользователей..."})}),(0,a.jsx)(v.aY,{children:(0,a.jsx)("div",{className:"animate-pulse space-y-4",children:[void 0,void 0,void 0,void 0,void 0].map((e,s)=>(0,a.jsx)("div",{className:"h-16 bg-gray-200 rounded"},s))})})]}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)(v.Zb,{children:[(0,a.jsxs)(v.Ol,{children:[(0,a.jsxs)(v.ll,{className:"flex items-center",children:[(0,a.jsx)(x.Z,{className:"h-5 w-5 mr-2"}),"Управление пользователями (",(null==n?void 0:n.length)||0,")"]}),(0,a.jsx)(v.SZ,{children:"Управляйте аккаунтами пользователей и их правами"})]}),(0,a.jsx)(v.aY,{children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(L.Z,{className:"h-4 w-4 text-gray-400"}),(0,a.jsx)(A.I,{placeholder:"Поиск пользователей по имени или email...",value:s,onChange:e=>t(e.target.value),className:"max-w-sm"})]})})]}),(0,a.jsx)("div",{className:"grid gap-4",children:0===m.length?(0,a.jsx)(v.Zb,{children:(0,a.jsxs)(v.aY,{className:"text-center py-8",children:[(0,a.jsx)(x.Z,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),(0,a.jsx)("p",{className:"text-gray-500",children:s?"Пользователи, соответствующие вашему запросу, не найдены":"Пользователи не найдены"})]})}):m.map(e=>(0,a.jsx)(v.Zb,{children:(0,a.jsx)(v.aY,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsxs)("h3",{className:"font-semibold text-lg",children:[e.firstName," ",e.lastName]}),(0,a.jsx)(r.C,{variant:e.isActive?"default":"secondary",children:e.isActive?"Активен":"Неактивен"}),(0,a.jsx)(r.C,{variant:"outline",children:e.role})]}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-4 text-sm text-gray-600",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(Q,{className:"h-4 w-4 mr-1"}),e.email]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(N.Z,{className:"h-4 w-4 mr-1"}),"Зарегистрирован"," ",new Date(e.createdAt).toLocaleDateString()]}),e.lastLogin&&(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(D,{className:"h-4 w-4 mr-1"}),"Последний вход"," ",new Date(e.lastLogin).toLocaleDateString()]})]})]}),(0,a.jsx)("div",{className:"flex gap-2",children:(0,a.jsx)(_.z,{size:"sm",variant:e.isActive?"destructive":"default",onClick:()=>o(e._id,e.isActive),disabled:l[e._id],children:e.isActive?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(I,{className:"h-4 w-4 mr-1"}),l[e._id]?"...":"Деактивировать"]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(D,{className:"h-4 w-4 mr-1"}),l[e._id]?"...":"Активировать"]})})})]})})},e._id))})]})}let E=(0,n.Z)("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);function H(){let e=(0,u.useQueryClient)(),[s,t]=(0,U.useState)({}),{data:l,isLoading:n}=(0,u.useQuery)("reported-content",async()=>(await j.hi.get("/admin/reported-content")).data),c=(0,u.useMutation)(async e=>{let{type:s,id:t,action:a}=e;await j.hi.patch("/admin/reported-content/".concat(s,"/").concat(t),{action:a})},{onSuccess:()=>{e.invalidateQueries("reported-content"),e.invalidateQueries("admin-stats"),O.ZP.success("Контент успешно обработан")},onError:()=>{O.ZP.error("Не удалось обработать жалобу на контент")}}),d=async(e,s,a)=>{t(e=>({...e,["".concat(s,"-").concat(a)]:!0}));try{await c.mutateAsync({type:e,id:s,action:a})}finally{t(e=>({...e,["".concat(s,"-").concat(a)]:!1}))}};if(n)return(0,a.jsxs)(v.Zb,{children:[(0,a.jsx)(v.Ol,{children:(0,a.jsx)(v.ll,{children:"Загрузка жалоб..."})}),(0,a.jsx)(v.aY,{children:(0,a.jsx)("div",{className:"animate-pulse space-y-4",children:[void 0,void 0,void 0].map((e,s)=>(0,a.jsx)("div",{className:"h-24 bg-gray-200 rounded"},s))})})]});let x=(null==l?void 0:l.propertyReviews)||[],m=(null==l?void 0:l.tenantReviews)||[],h=x.length+m.length;return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)(v.Zb,{children:(0,a.jsxs)(v.Ol,{children:[(0,a.jsxs)(v.ll,{className:"flex items-center",children:[(0,a.jsx)(o,{className:"h-5 w-5 mr-2 text-red-600"}),"Жалобы на контент (",h,")"]}),(0,a.jsx)(v.SZ,{children:"Отзывы и комментарии, на которые пожаловались пользователи"})]})}),0===h?(0,a.jsx)(v.Zb,{children:(0,a.jsxs)(v.aY,{className:"text-center py-8",children:[(0,a.jsx)(o,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),(0,a.jsx)("p",{className:"text-gray-500",children:"На данный момент жалоб нет"})]})}):(0,a.jsxs)(i.mQ,{defaultValue:"property",className:"space-y-4",children:[(0,a.jsxs)(i.dr,{className:"grid w-full grid-cols-2",children:[(0,a.jsxs)(i.SP,{value:"property",className:"flex items-center gap-2",children:[(0,a.jsx)(p.Z,{className:"h-4 w-4"}),"Недвижимость (",x.length,")"]}),(0,a.jsxs)(i.SP,{value:"tenant",className:"flex items-center gap-2",children:[(0,a.jsx)(g.Z,{className:"h-4 w-4"}),"Арендатор (",m.length,")"]})]}),(0,a.jsx)(i.nU,{value:"property",className:"space-y-4",children:0===x.length?(0,a.jsx)(v.Zb,{children:(0,a.jsx)(v.aY,{className:"text-center py-8",children:(0,a.jsx)("p",{className:"text-gray-500",children:"Нет жалоб на отзывы о недвижимости"})})}):x.map(e=>(0,a.jsxs)(v.Zb,{className:"border-red-200",children:[(0,a.jsx)(v.Ol,{children:(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(v.ll,{className:"flex items-center text-lg",children:[(0,a.jsx)(p.Z,{className:"h-5 w-5 mr-2 text-blue-600"}),e.street," ",e.building,", ",e.city]}),(0,a.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,a.jsxs)(r.C,{variant:"destructive",children:[e.reportCount," жалоб",e.reportCount>1?"ы":"а"]}),(0,a.jsxs)(r.C,{variant:"secondary",children:[e.numberOfRooms," комнат"]}),(0,a.jsxs)("span",{className:"text-sm text-gray-600",children:["от ",e.author.firstName," ",e.author.lastName]})]})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(_.z,{size:"sm",variant:"outline",onClick:()=>d("property",e._id,"dismiss"),disabled:s["".concat(e._id,"-dismiss")],children:[(0,a.jsx)(E,{className:"h-4 w-4 mr-1"}),s["".concat(e._id,"-dismiss")]?"...":"Снять жалобу"]}),(0,a.jsxs)(_.z,{size:"sm",onClick:()=>d("property",e._id,"approve"),disabled:s["".concat(e._id,"-approve")],className:"bg-green-600 hover:bg-green-700",children:[(0,a.jsx)(Y.Z,{className:"h-4 w-4 mr-1"}),s["".concat(e._id,"-approve")]?"...":"Одобрить"]}),(0,a.jsxs)(_.z,{size:"sm",variant:"destructive",onClick:()=>d("property",e._id,"delete"),disabled:s["".concat(e._id,"-delete")],children:[(0,a.jsx)(M.Z,{className:"h-4 w-4 mr-1"}),s["".concat(e._id,"-delete")]?"...":"Удалить"]})]})]})}),(0,a.jsx)(v.aY,{children:(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center text-sm text-gray-600",children:[(0,a.jsx)(N.Z,{className:"h-4 w-4 mr-2"}),"Аренда: ",e.rentalPeriod.from.month,"/",e.rentalPeriod.from.year," -"," ",e.rentalPeriod.to.month,"/",e.rentalPeriod.to.year]}),(0,a.jsxs)("div",{className:"text-sm",children:[(0,a.jsx)("span",{className:"font-medium",children:"Арендодатель:"})," ",e.landlordName]}),(0,a.jsx)("p",{className:"text-gray-700",children:e.reviewText}),(0,a.jsxs)("div",{className:"text-xs text-gray-500",children:["Добавлено:"," ",new Date(e.createdAt).toLocaleString("ru-RU")]})]})})]},e._id))}),(0,a.jsx)(i.nU,{value:"tenant",className:"space-y-4",children:0===m.length?(0,a.jsx)(v.Zb,{children:(0,a.jsx)(v.aY,{className:"text-center py-8",children:(0,a.jsx)("p",{className:"text-gray-500",children:"Нет жалоб на отзывы об арендаторах"})})}):m.map(e=>(0,a.jsxs)(v.Zb,{className:"border-red-200",children:[(0,a.jsx)(v.Ol,{children:(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(v.ll,{className:"flex items-center text-lg",children:[(0,a.jsx)(g.Z,{className:"h-5 w-5 mr-2 text-green-600"}),e.tenantFullName]}),(0,a.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,a.jsxs)(r.C,{variant:"destructive",children:[e.reportCount," жалоб",e.reportCount>1?"ы":"а"]}),(0,a.jsxs)(r.C,{variant:"secondary",children:["ИНН: ***",e.tenantIdLastFour]}),(0,a.jsxs)(r.C,{variant:"secondary",children:["Тел: ***",e.tenantPhoneLastFour]}),(0,a.jsxs)("span",{className:"text-sm text-gray-600",children:["от ",e.author.firstName," ",e.author.lastName]})]})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(_.z,{size:"sm",variant:"outline",onClick:()=>d("tenant",e._id,"dismiss"),disabled:s["".concat(e._id,"-dismiss")],children:[(0,a.jsx)(E,{className:"h-4 w-4 mr-1"}),s["".concat(e._id,"-dismiss")]?"...":"Снять жалобу"]}),(0,a.jsxs)(_.z,{size:"sm",onClick:()=>d("tenant",e._id,"approve"),disabled:s["".concat(e._id,"-approve")],className:"bg-green-600 hover:bg-green-700",children:[(0,a.jsx)(Y.Z,{className:"h-4 w-4 mr-1"}),s["".concat(e._id,"-approve")]?"...":"Одобрить"]}),(0,a.jsxs)(_.z,{size:"sm",variant:"destructive",onClick:()=>d("tenant",e._id,"delete"),disabled:s["".concat(e._id,"-delete")],children:[(0,a.jsx)(M.Z,{className:"h-4 w-4 mr-1"}),s["".concat(e._id,"-delete")]?"...":"Удалить"]})]})]})}),(0,a.jsx)(v.aY,{children:(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center text-sm text-gray-600",children:[(0,a.jsx)(N.Z,{className:"h-4 w-4 mr-2"}),"Аренда: ",e.rentalPeriod.from.month,"/",e.rentalPeriod.from.year," -"," ",e.rentalPeriod.to.month,"/",e.rentalPeriod.to.year]}),(0,a.jsx)("p",{className:"text-gray-700",children:e.reviewText}),(0,a.jsxs)("div",{className:"text-xs text-gray-500",children:["Добавлено:"," ",new Date(e.createdAt).toLocaleString("ru-RU")]})]})})]},e._id))})]})]})}function T(){let e=(0,u.useQueryClient)(),[s,t]=(0,U.useState)("pending"),{data:l,isLoading:r}=(0,u.useQuery)("admin-comments",async()=>(await j.hi.get("/admin/comments")).data),n=(0,u.useMutation)(async e=>{let{type:s,reviewId:t,commentId:a,action:l}=e;await j.hi.patch("/admin/".concat(s,"-reviews/").concat(t,"/comments/").concat(a,"/moderate"),{action:l})},{onSuccess:()=>{e.invalidateQueries("admin-comments"),O.ZP.success("Комментарий успешно модерирован")},onError:()=>{O.ZP.error("Не удалось модерировать комментарий")}});if(r)return(0,a.jsx)("div",{className:"text-center py-8",children:"Загрузка комментариев..."});let c=(null==l?void 0:l.propertyComments)||[],d=(null==l?void 0:l.tenantComments)||[];return(0,a.jsxs)(v.Zb,{children:[(0,a.jsxs)(v.Ol,{children:[(0,a.jsxs)(v.ll,{className:"flex items-center",children:[(0,a.jsx)(m,{className:"h-5 w-5 mr-2"}),"Модерация комментариев"]}),(0,a.jsx)(v.SZ,{children:"Проверьте, одобрите или удалите комментарии пользователей"})]}),(0,a.jsx)(v.aY,{children:(0,a.jsxs)(i.mQ,{value:s,onValueChange:t,className:"space-y-4",children:[(0,a.jsxs)(i.dr,{className:"grid w-full grid-cols-3 mb-4",children:[(0,a.jsx)(i.SP,{value:"pending",children:"Ожидают"}),(0,a.jsx)(i.SP,{value:"reported",children:"Жалобы"}),(0,a.jsx)(i.SP,{value:"approved",children:"Одобренные"})]}),(0,a.jsx)(i.nU,{value:s,children:(0,a.jsx)("div",{className:"space-y-4",children:["property","tenant"].map(e=>{var t;let l=(t="property"===e?c:d,"pending"===s?t.filter(e=>!e.isApproved&&!e.isReported):"reported"===s?t.filter(e=>e.isReported):"approved"===s?t.filter(e=>e.isApproved&&!e.isReported):t);return(0,a.jsxs)("div",{children:[(0,a.jsxs)("h4",{className:"font-semibold mb-2",children:["property"===e?"Недвижимость":"Арендаторы"," (",l.length,")"]}),0===l.length?(0,a.jsx)("div",{className:"text-xs text-gray-500 mb-4",children:"Нет комментариев"}):l.map(s=>{var t,l;return(0,a.jsxs)("div",{className:"border rounded p-2 bg-gray-50 flex flex-col mb-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("span",{className:"text-xs text-gray-600",children:[null===(t=s.author)||void 0===t?void 0:t.firstName," ",null===(l=s.author)||void 0===l?void 0:l.lastName," •"," ",new Date(s.createdAt).toLocaleString()]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[!s.isApproved&&(0,a.jsxs)(_.z,{size:"sm",onClick:()=>n.mutate({type:e,reviewId:s.reviewId,commentId:s._id,action:"approve"}),children:[(0,a.jsx)(Y.Z,{className:"h-4 w-4 mr-1"})," Одобрить"]}),(0,a.jsxs)(_.z,{size:"sm",variant:"destructive",onClick:()=>n.mutate({type:e,reviewId:s.reviewId,commentId:s._id,action:"delete"}),children:[(0,a.jsx)(M.Z,{className:"h-4 w-4 mr-1"})," Удалить"]})]})]}),(0,a.jsx)("div",{className:"text-sm text-gray-800 mt-1",children:s.text}),s.isReported&&(0,a.jsxs)("div",{className:"text-xs text-red-600 mt-1 flex items-center",children:[(0,a.jsx)(o,{className:"h-3 w-3 mr-1"})," ","Жалоб: ",s.reportCount||1]})]},s._id)})]},e)})})})]})})]})}function q(){let{user:e,loading:s}=(0,l.a)(),t=(0,h.useRouter)();return s?(0,a.jsx)("div",{className:"text-center py-16",children:"Загрузка..."}):e?"admin"!==e.role&&"moderator"!==e.role?(0,a.jsxs)("div",{className:"text-center py-16",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-red-600 mb-4",children:"Доступ запрещен"}),(0,a.jsx)("p",{className:"text-gray-600",children:"У вас нет прав для доступа к панели администратора."})]}):(0,a.jsxs)("div",{className:"space-y-8",children:[(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold",children:"Панель администратора"}),(0,a.jsx)("p",{className:"text-gray-600 mt-1",children:"Управление отзывами, пользователями и мониторинг активности платформы"})]}),(0,a.jsx)(r.C,{variant:"secondary",className:"w-fit mt-2 sm:mt-0",children:"admin"===e.role?"Администратор":"Модератор"})]}),(0,a.jsxs)(i.mQ,{defaultValue:"overview",className:"space-y-6",children:[(0,a.jsxs)(i.dr,{className:"grid w-full grid-cols-2 lg:grid-cols-5",children:[(0,a.jsxs)(i.SP,{value:"overview",className:"flex items-center gap-2",children:[(0,a.jsx)(c,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"hidden sm:inline",children:"Обзор"})]}),(0,a.jsxs)(i.SP,{value:"moderation",className:"flex items-center gap-2",children:[(0,a.jsx)(d.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"hidden sm:inline",children:"Модерация"})]}),(0,a.jsxs)(i.SP,{value:"users",className:"flex items-center gap-2",children:[(0,a.jsx)(x.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"hidden sm:inline",children:"Пользователи"})]}),(0,a.jsxs)(i.SP,{value:"reports",className:"flex items-center gap-2",children:[(0,a.jsx)(o,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"hidden sm:inline",children:"Жалобы"})]}),(0,a.jsxs)(i.SP,{value:"comments",className:"flex items-center gap-2",children:[(0,a.jsx)(m,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"hidden sm:inline",children:"Комментарии"})]})]}),(0,a.jsx)(i.nU,{value:"overview",children:(0,a.jsx)(S,{})}),(0,a.jsx)(i.nU,{value:"moderation",children:(0,a.jsx)(z,{})}),(0,a.jsx)(i.nU,{value:"users",children:(0,a.jsx)(V,{})}),(0,a.jsx)(i.nU,{value:"reports",children:(0,a.jsx)(H,{})}),(0,a.jsx)(i.nU,{value:"comments",children:(0,a.jsx)(T,{})})]})]}):(t.push("/login"),null)}},5974:function(e,s,t){"use strict";t.d(s,{C:function(){return n}});var a=t(7437);t(2265);var l=t(535),r=t(4508);let i=(0,l.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function n(e){let{className:s,variant:t,...l}=e;return(0,a.jsx)("div",{className:(0,r.cn)(i({variant:t}),s),...l})}},2869:function(e,s,t){"use strict";t.d(s,{z:function(){return d}});var a=t(7437),l=t(2265),r=t(7053),i=t(535),n=t(4508);let c=(0,i.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=l.forwardRef((e,s)=>{let{className:t,variant:l,size:i,asChild:d=!1,...x}=e,o=d?r.g7:"button";return(0,a.jsx)(o,{className:(0,n.cn)(c({variant:l,size:i,className:t})),ref:s,...x})});d.displayName="Button"},6070:function(e,s,t){"use strict";t.d(s,{Ol:function(){return n},SZ:function(){return d},Zb:function(){return i},aY:function(){return x},ll:function(){return c}});var a=t(7437),l=t(2265),r=t(4508);let i=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("div",{ref:s,className:(0,r.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",t),...l})});i.displayName="Card";let n=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("div",{ref:s,className:(0,r.cn)("flex flex-col space-y-1.5 p-6",t),...l})});n.displayName="CardHeader";let c=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("div",{ref:s,className:(0,r.cn)("text-2xl font-semibold leading-none tracking-tight",t),...l})});c.displayName="CardTitle";let d=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("div",{ref:s,className:(0,r.cn)("text-sm text-muted-foreground",t),...l})});d.displayName="CardDescription";let x=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("div",{ref:s,className:(0,r.cn)("p-6 pt-0",t),...l})});x.displayName="CardContent",l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("div",{ref:s,className:(0,r.cn)("flex items-center p-6 pt-0",t),...l})}).displayName="CardFooter"},5186:function(e,s,t){"use strict";t.d(s,{I:function(){return i}});var a=t(7437),l=t(2265),r=t(4508);let i=l.forwardRef((e,s)=>{let{className:t,type:l,error:i,...n}=e;return(0,a.jsx)("input",{type:l,className:(0,r.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",i&&"border-red-500 focus-visible:ring-red-500",t),ref:s,...n})});i.displayName="Input"},2339:function(e,s,t){"use strict";t.d(s,{SP:function(){return d},dr:function(){return c},mQ:function(){return n},nU:function(){return x}});var a=t(7437),l=t(2265),r=t(271),i=t(4508);let n=r.fC,c=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(r.aV,{ref:s,className:(0,i.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",t),...l})});c.displayName=r.aV.displayName;let d=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(r.xz,{ref:s,className:(0,i.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",t),...l})});d.displayName=r.xz.displayName;let x=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(r.VY,{ref:s,className:(0,i.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...l})});x.displayName=r.VY.displayName},8730:function(e,s,t){"use strict";t.d(s,{H:function(){return x},a:function(){return o}});var a=t(7437),l=t(2265),r=t(9376),i=t(4131),n=t(9116),c=t(9064);let d=(0,l.createContext)(void 0);function x(e){let{children:s}=e,[t,x]=(0,l.useState)(null),[o,m]=(0,l.useState)(!0),h=(0,r.useRouter)();(0,l.useEffect)(()=>{let e=i.Z.get("token");e?(n.hi.defaults.headers.common.Authorization="Bearer ".concat(e),u()):m(!1)},[]);let u=async()=>{try{let e=await n.hi.get("/auth/me");x(e.data.user)}catch(e){i.Z.remove("token"),delete n.hi.defaults.headers.common.Authorization}finally{m(!1)}},j=async(e,s)=>{try{let{token:t,user:a}=(await n.hi.post("/auth/login",{email:e,password:s})).data;i.Z.set("token",t,{expires:7}),n.hi.defaults.headers.common.Authorization="Bearer ".concat(t),x(a),c.ZP.success("Вход выполнен успешно!"),h.push("/dashboard")}catch(e){var t,a;throw c.ZP.error((null===(a=e.response)||void 0===a?void 0:null===(t=a.data)||void 0===t?void 0:t.message)||"Ошибка входа"),e}},v=async e=>{try{let{user:s}=(await n.hi.post("/auth/register",e)).data;c.ZP.success("Код подтверждения отправлен на ваш email. Пожалуйста, введите его для завершения регистрации."),h.push("/verify-email/verify?email=".concat(encodeURIComponent(s.email)))}catch(e){var s,t;throw c.ZP.error((null===(t=e.response)||void 0===t?void 0:null===(s=t.data)||void 0===s?void 0:s.message)||"Ошибка регистрации"),e}},p=async(e,s)=>{try{await n.hi.post("/auth/verify-email",{email:e,code:s}),c.ZP.success("Email успешно подтвержден!"),t?await u():h.push("/login")}catch(e){var a,l;throw c.ZP.error((null===(l=e.response)||void 0===l?void 0:null===(a=l.data)||void 0===a?void 0:a.message)||"Ошибка подтверждения email"),e}};return(0,a.jsx)(d.Provider,{value:{user:t,login:j,register:v,verifyEmail:p,logout:()=>{i.Z.remove("token"),delete n.hi.defaults.headers.common.Authorization,x(null),c.ZP.success("Вы успешно вышли из системы"),h.push("/")},loading:o},children:s})}function o(){let e=(0,l.useContext)(d);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},9116:function(e,s,t){"use strict";t.d(s,{PH:function(){return i},hi:function(){return r},zy:function(){return n}});var a=t(3464),l=t(257);let r=a.Z.create({baseURL:l.env.NEXT_PUBLIC_API_URL||"http://localhost:4100/api",headers:{"Content-Type":"application/json"}});r.interceptors.request.use(e=>e,e=>Promise.reject(e)),r.interceptors.response.use(e=>e,e=>{var s;return(null===(s=e.response)||void 0===s?void 0:s.status)===401&&(window.location.href="/login"),Promise.reject(e)});let i={getRememberedAddresses:async function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,t=new URLSearchParams;return e&&t.append("city",e),t.append("limit",s.toString()),(await r.get("/addresses/remembered?".concat(t))).data},saveRememberedAddress:async e=>(await r.post("/addresses/remembered",e)).data,getPopularAddresses:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:20;return(await r.get("/addresses/popular?limit=".concat(e))).data},searchAddresses:async function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;return(await r.get("/addresses/search?q=".concat(encodeURIComponent(e),"&limit=").concat(s))).data}},n={getTrendingTopics:async()=>(await r.get("/recommendations/trending-topics")).data,getStats:async()=>(await r.get("/recommendations/stats")).data,getUserPreferences:async()=>(await r.get("/recommendations/user-preferences")).data}},4508:function(e,s,t){"use strict";t.d(s,{cn:function(){return r}});var a=t(1994),l=t(3335);function r(){for(var e=arguments.length,s=Array(e),t=0;t<e;t++)s[t]=arguments[t];return(0,l.m6)((0,a.W)(s))}},1047:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(9205).Z)("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},401:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(9205).Z)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},3247:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(9205).Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},2369:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(9205).Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},2489:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(9205).Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])}},function(e){e.O(0,[72,278,634,23,971,117,744],function(){return e(e.s=9474)}),_N_E=e.O()}]);