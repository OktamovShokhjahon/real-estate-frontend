(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[885],{923:(e,s,r)=>{"use strict";r.d(s,{Xi:()=>d,av:()=>o,j7:()=>c,tU:()=>i});var a=r(5155),t=r(2115),l=r(5667),n=r(5016);let i=l.bL,c=t.forwardRef((e,s)=>{let{className:r,...t}=e;return(0,a.jsx)(l.B8,{ref:s,className:(0,n.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",r),...t})});c.displayName=l.B8.displayName;let d=t.forwardRef((e,s)=>{let{className:r,...t}=e;return(0,a.jsx)(l.l9,{ref:s,className:(0,n.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",r),...t})});d.displayName=l.l9.displayName;let o=t.forwardRef((e,s)=>{let{className:r,...t}=e;return(0,a.jsx)(l.UC,{ref:s,className:(0,n.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",r),...t})});o.displayName=l.UC.displayName},2734:(e,s,r)=>{"use strict";r.d(s,{A:()=>m,O:()=>x});var a=r(5155),t=r(2115),l=r(63),n=r(2378),i=r(7621),c=r(2663),d=r(5016);let o=(0,t.createContext)(void 0);function x(e){let{children:s}=e,[r,x]=(0,t.useState)(null),[m,u]=(0,t.useState)(!0),[h,g]=(0,t.useState)(!1),p=(0,l.useRouter)();(0,t.useEffect)(()=>{let e=n.A.get("token");e?(i.FH.defaults.headers.common.Authorization="Bearer ".concat(e),j()):u(!1)},[]);let j=async()=>{try{let e=await i.FH.get("/auth/me");x(e.data.user)}catch(e){n.A.remove("token"),delete i.FH.defaults.headers.common.Authorization,x(null)}finally{u(!1)}},f=async(e,s)=>{g(!0);try{let{token:r,user:a}=(await i.FH.post("/auth/login",{email:e,password:s})).data;i.FH.defaults.headers.common.Authorization="Bearer ".concat(r),x(a),c.Ay.success("Вход выполнен успешно!"),p.push((0,d.Y)("/dashboard"))}catch(e){var r,a,t,l,n,o;throw console.error("Login error:",e),(null==(r=e.response)?void 0:r.status)===401?c.Ay.error("Неверные учетные данные"):(null==(a=e.response)?void 0:a.status)===0||"NETWORK_ERROR"===e.code?c.Ay.error("Ошибка сети. Проверьте подключение к интернету."):(null==(t=e.message)?void 0:t.includes("cookie"))||(null==(l=e.message)?void 0:l.includes("CORS"))?c.Ay.error("Ошибка браузера. Попробуйте обновить страницу или использовать другой браузер."):c.Ay.error((null==(o=e.response)||null==(n=o.data)?void 0:n.message)||"Ошибка входа"),e}finally{g(!1)}},v=async e=>{g(!0);try{let{user:s}=(await i.FH.post("/auth/register",e)).data;c.Ay.success("Код подтверждения отправлен на ваш email. Пожалуйста, введите его для завершения регистрации."),p.push("".concat((0,d.Y)("/verify-email/verify"),"?email=").concat(encodeURIComponent(s.email)))}catch(e){var s,r,a,t,l,n,o,x;throw console.error("Register error:",e),(null==(s=e.response)?void 0:s.status)===400?c.Ay.error((null==(n=e.response)||null==(l=n.data)?void 0:l.message)||"Ошибка валидации данных"):(null==(r=e.response)?void 0:r.status)===0||"NETWORK_ERROR"===e.code?c.Ay.error("Ошибка сети. Проверьте подключение к интернету."):(null==(a=e.message)?void 0:a.includes("cookie"))||(null==(t=e.message)?void 0:t.includes("CORS"))?c.Ay.error("Ошибка браузера. Попробуйте обновить страницу или использовать другой браузер."):c.Ay.error((null==(x=e.response)||null==(o=x.data)?void 0:o.message)||"Ошибка регистрации"),e}finally{g(!1)}},y=async(e,s)=>{g(!0);try{await i.FH.post("/auth/verify-email",{email:e,code:s}),c.Ay.success("Email успешно подтвержден!"),r?await j():p.push((0,d.Y)("/login"))}catch(e){var a,t;throw c.Ay.error((null==(t=e.response)||null==(a=t.data)?void 0:a.message)||"Ошибка подтверждения email"),e}finally{g(!1)}};return(0,a.jsx)(o.Provider,{value:{user:r,isLoading:m,loading:h,login:f,register:v,verifyEmail:y,logout:()=>{n.A.remove("token",{path:"/"}),delete i.FH.defaults.headers.common.Authorization,x(null),c.Ay.success("Вы успешно вышли из системы"),p.push("/")}},children:s})}function m(){let e=(0,t.useContext)(o);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},3209:(e,s,r)=>{"use strict";r.d(s,{BT:()=>d,Wu:()=>o,ZB:()=>c,Zp:()=>n,aR:()=>i});var a=r(5155),t=r(2115),l=r(5016);let n=t.forwardRef((e,s)=>{let{className:r,...t}=e;return(0,a.jsx)("div",{ref:s,className:(0,l.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",r),...t})});n.displayName="Card";let i=t.forwardRef((e,s)=>{let{className:r,...t}=e;return(0,a.jsx)("div",{ref:s,className:(0,l.cn)("flex flex-col space-y-1.5 p-6",r),...t})});i.displayName="CardHeader";let c=t.forwardRef((e,s)=>{let{className:r,...t}=e;return(0,a.jsx)("div",{ref:s,className:(0,l.cn)("text-2xl font-semibold leading-none tracking-tight",r),...t})});c.displayName="CardTitle";let d=t.forwardRef((e,s)=>{let{className:r,...t}=e;return(0,a.jsx)("div",{ref:s,className:(0,l.cn)("text-sm text-muted-foreground",r),...t})});d.displayName="CardDescription";let o=t.forwardRef((e,s)=>{let{className:r,...t}=e;return(0,a.jsx)("div",{ref:s,className:(0,l.cn)("p-6 pt-0",r),...t})});o.displayName="CardContent",t.forwardRef((e,s)=>{let{className:r,...t}=e;return(0,a.jsx)("div",{ref:s,className:(0,l.cn)("flex items-center p-6 pt-0",r),...t})}).displayName="CardFooter"},5016:(e,s,r)=>{"use strict";r.d(s,{Y:()=>n,cn:()=>l});var a=r(2821),t=r(5889);function l(){for(var e=arguments.length,s=Array(e),r=0;r<e;r++)s[r]=arguments[r];return(0,t.QP)((0,a.$)(s))}function n(e){return e}},5757:(e,s,r)=>{Promise.resolve().then(r.bind(r,6043))},6043:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>R});var a=r(5155),t=r(2115),l=r(5108),n=r(2734),i=r(7621),c=r(3209),d=r(1871),o=r(5993),x=r(9347),m=r(1169),u=r(1524),h=r(2619),g=r.n(h);function p(){let{data:e,isLoading:s,error:r}=(0,l.useQuery)(["trending-topics"],i.G9.getTrendingTopics);return s?(0,a.jsxs)(c.Zp,{children:[(0,a.jsx)(c.aR,{children:(0,a.jsxs)(c.ZB,{className:"flex items-center",children:[(0,a.jsx)(u.A,{className:"h-5 w-5 mr-2 text-orange-500"}),"Трендовые темы"]})}),(0,a.jsx)(c.Wu,{children:(0,a.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:[...Array(6)].map((e,s)=>(0,a.jsx)("div",{className:"p-3 rounded-lg border animate-pulse",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-gray-200 dark:bg-gray-700 rounded-full"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded mb-1"}),(0,a.jsx)("div",{className:"h-3 bg-gray-200 dark:bg-gray-700 rounded w-16"})]})]})},s))})})]}):!r&&(null==e?void 0:e.trendingTopics)?(0,a.jsxs)(c.Zp,{children:[(0,a.jsx)(c.aR,{children:(0,a.jsxs)(c.ZB,{className:"flex items-center",children:[(0,a.jsx)(u.A,{className:"h-5 w-5 mr-2 text-orange-500"}),"Трендовые темы"]})}),(0,a.jsx)(c.Wu,{children:(0,a.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:e.trendingTopics.map(e=>(0,a.jsx)(g(),{href:e.href,className:"block p-3 rounded-lg border hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"p-2 rounded-full ".concat((e=>{switch(e){case"city":return"bg-blue-100 text-blue-600 dark:bg-blue-900 dark:text-blue-400";case"room":return"bg-purple-100 text-purple-600 dark:bg-purple-900 dark:text-purple-400";case"rating":return"bg-yellow-100 text-yellow-600 dark:bg-yellow-900 dark:text-yellow-400";case"recent":return"bg-red-100 text-red-600 dark:bg-red-900 dark:text-red-400";default:return"bg-gray-100 text-gray-600 dark:bg-gray-900 dark:text-gray-400"}})(e.type)),children:(e=>{switch(e){case"city":return(0,a.jsx)(d.A,{className:"h-4 w-4"});case"room":return(0,a.jsx)(o.A,{className:"h-4 w-4"});case"rating":return(0,a.jsx)(x.A,{className:"h-4 w-4"});case"recent":return(0,a.jsx)(m.A,{className:"h-4 w-4"});default:return(0,a.jsx)(u.A,{className:"h-4 w-4"})}})(e.type)}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("div",{className:"font-medium text-sm truncate dark:text-gray-200",children:e.name}),(0,a.jsxs)("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:[e.count," отзывов"]})]})]})},e.id))})})]}):(0,a.jsxs)(c.Zp,{children:[(0,a.jsx)(c.aR,{children:(0,a.jsxs)(c.ZB,{className:"flex items-center",children:[(0,a.jsx)(u.A,{className:"h-5 w-5 mr-2 text-orange-500"}),"Трендовые темы"]})}),(0,a.jsx)(c.Wu,{children:(0,a.jsxs)("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:[(0,a.jsx)(u.A,{className:"h-12 w-12 mx-auto mb-4 text-gray-300 dark:text-gray-600"}),(0,a.jsx)("p",{children:"Не удалось загрузить трендовые темы"})]})})]})}var j=r(7812),f=r(7003),v=r(923),y=r(1873),N=r(3457),b=r(2987),w=r(6983),A=r(5276),k=r(63);function R(){var e,s,r,o,h;let{user:R}=(0,n.A)(),C=(0,k.useRouter)(),[Z,B]=(0,t.useState)(null),{data:T,isLoading:U}=(0,l.useQuery)(["recent-reviews"],async()=>(await i.FH.get("/property/reviews?limit=8")).data),{data:_,isLoading:E}=(0,l.useQuery)(["popular-addresses"],async()=>(await i.hA.getPopularAddresses(8)).data),{data:W,isLoading:F}=(0,l.useQuery)(["high-rated-reviews"],async()=>((await i.FH.get("/property/reviews?limit=6")).data.reviews||[]).filter(e=>"number"==typeof e.rating&&e.rating>=4)),{data:P}=(0,l.useQuery)(["user-preferences",null==R?void 0:R.email],i.G9.getUserPreferences,{enabled:!!R}),{data:O,isLoading:z}=(0,l.useQuery)(["recommendation-stats"],i.G9.getStats);(0,t.useEffect)(()=>{if(O)B(O);else if(T&&_){let e=T.reviews||[],s=_.addresses||[],r=e.reduce((e,s)=>e+(s.rating||0),0),a=e.length>0?r/e.length:0,t={};s.forEach(e=>{t[e.city]=(t[e.city]||0)+e.usageCount});let l=Object.keys(t).reduce((e,s)=>t[e]>t[s]?e:s)||"Неизвестно";B({totalReviews:e.length,totalAddresses:s.length,averageRating:Math.round(10*a)/10,mostPopularCity:l})}},[O,T,_]);let H=e=>new Date(e).toLocaleDateString("ru-RU",{year:"numeric",month:"long",day:"numeric"}),L=e=>e>=4?"text-green-600":e>=3?"text-yellow-600":"text-red-600";return(t.useEffect(()=>{R||C.push("/login")},[R,C]),R)?U||E||F||z?(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold mb-2",children:"Рекомендации для вас"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Персонализированные рекомендации на основе ваших предпочтений и популярного контента"})]}),(0,a.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Загрузка рекомендаций..."})]})})]}):(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold mb-2 dark:text-white",children:"Рекомендации для вас"}),(0,a.jsx)("p",{className:"text-gray-600 dark:text-gray-300",children:"Персонализированные рекомендации на основе ваших предпочтений и популярного контента"})]}),Z&&(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-8",children:[(0,a.jsx)(c.Zp,{children:(0,a.jsx)(c.Wu,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(d.A,{className:"h-5 w-5 text-blue-600"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:"Всего отзывов"}),(0,a.jsx)("p",{className:"text-2xl font-bold dark:text-white",children:Z.totalReviews})]})]})})}),(0,a.jsx)(c.Zp,{children:(0,a.jsx)(c.Wu,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(y.A,{className:"h-5 w-5 text-green-600"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:"Популярных адресов"}),(0,a.jsx)("p",{className:"text-2xl font-bold dark:text-white",children:Z.totalAddresses})]})]})})}),(0,a.jsx)(c.Zp,{children:(0,a.jsx)(c.Wu,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(x.A,{className:"h-5 w-5 text-yellow-600"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:"Средний рейтинг"}),(0,a.jsx)("p",{className:"text-2xl font-bold dark:text-white",children:Z.averageRating})]})]})})}),(0,a.jsx)(c.Zp,{children:(0,a.jsx)(c.Wu,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(u.A,{className:"h-5 w-5 text-purple-600"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:"Популярный город"}),(0,a.jsx)("p",{className:"text-2xl font-bold dark:text-white",children:Z.mostPopularCity})]})]})})})]}),(0,a.jsxs)(v.tU,{defaultValue:"recommended",className:"space-y-6",children:[(0,a.jsxs)(v.j7,{className:"grid w-full grid-cols-3",children:[(0,a.jsxs)(v.Xi,{value:"recommended",className:"flex items-center space-x-2",children:[(0,a.jsx)(N.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Рекомендуемое"})]}),(0,a.jsxs)(v.Xi,{value:"popular",className:"flex items-center space-x-2",children:[(0,a.jsx)(u.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Популярное"})]}),(0,a.jsxs)(v.Xi,{value:"high-rated",className:"flex items-center space-x-2",children:[(0,a.jsx)(x.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Высокий рейтинг"})]})]}),(0,a.jsxs)(v.av,{value:"recommended",className:"space-y-6",children:[(0,a.jsx)(p,{}),P&&(0,a.jsxs)(c.Zp,{children:[(0,a.jsxs)(c.aR,{children:[(0,a.jsxs)(c.ZB,{className:"flex items-center",children:[(0,a.jsx)(N.A,{className:"h-5 w-5 mr-2 text-red-500"}),"Основано на ваших предпочтениях"]}),(0,a.jsxs)(c.BT,{children:["Рекомендации на основе вашего города:"," ",P.preferredCity]})]}),(0,a.jsx)(c.Wu,{children:(0,a.jsx)("div",{className:"grid gap-4",children:null==_||null==(e=_.addresses)?void 0:e.filter(e=>e.city===P.preferredCity).slice(0,4).map(e=>(0,a.jsx)(g(),{href:"/property?city=".concat(encodeURIComponent(e.city),"&street=").concat(encodeURIComponent(e.street),"&building=").concat(encodeURIComponent(e.building)),className:"block p-4 rounded-lg border hover:bg-gray-50 transition-colors",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"p-2 bg-red-100 rounded-full",children:(0,a.jsx)(N.A,{className:"h-4 w-4 text-red-500"})}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"font-medium",children:[e.street," ",e.building]}),(0,a.jsxs)("div",{className:"text-sm text-gray-500",children:[e.city,e.residentialComplex&&(0,a.jsxs)("span",{className:"ml-1",children:["• ",e.residentialComplex]})]})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsxs)(j.E,{variant:"secondary",children:[e.usageCount," отзывов"]}),(0,a.jsx)(b.A,{className:"h-4 w-4 text-gray-400"})]})]})},e._id))})})]}),(0,a.jsxs)(c.Zp,{children:[(0,a.jsx)(c.aR,{children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)(c.ZB,{className:"flex items-center",children:[(0,a.jsx)(w.A,{className:"h-5 w-5 mr-2 text-blue-500"}),"Недавние отзывы"]}),(0,a.jsx)(c.BT,{children:"Последние отзывы, которые могут вас заинтересовать"})]}),(0,a.jsx)(f.$,{variant:"outline",size:"sm",asChild:!0,children:(0,a.jsx)(g(),{href:"/property",children:"Смотреть все"})})]})}),(0,a.jsx)(c.Wu,{children:(0,a.jsx)("div",{className:"grid gap-4",children:(null==T||null==(s=T.reviews)?void 0:s.length)===0?(0,a.jsxs)("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:[(0,a.jsx)(w.A,{className:"h-12 w-12 mx-auto mb-4 text-gray-300 dark:text-gray-600"}),(0,a.jsx)("p",{children:"Пока нет отзывов"})]}):null==T||null==(r=T.reviews)?void 0:r.slice(0,4).map(e=>(0,a.jsx)(g(),{href:"/property/".concat(e._id),className:"block p-4 rounded-lg border hover:bg-gray-50 transition-colors",children:(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,a.jsx)(y.A,{className:"h-4 w-4 text-gray-500"}),(0,a.jsxs)("span",{className:"font-medium",children:[e.street," ",e.building,","," ",e.city]}),"number"==typeof e.rating&&(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)(x.A,{className:"h-4 w-4 ".concat(L(e.rating))}),(0,a.jsx)("span",{className:"text-sm ".concat(L(e.rating)),children:e.rating})]})]}),(0,a.jsx)("p",{className:"text-sm text-gray-600 line-clamp-2",children:e.reviewText}),(0,a.jsxs)("div",{className:"flex items-center space-x-4 mt-2 text-xs text-gray-500",children:[(0,a.jsxs)("span",{children:[e.numberOfRooms," комнат"]}),(0,a.jsx)("span",{children:H(e.createdAt)}),(0,a.jsxs)("span",{children:[e.author.firstName," ",e.author.lastName]})]})]}),(0,a.jsx)(b.A,{className:"h-4 w-4 text-gray-400 ml-4"})]})},e._id))})})]})]}),(0,a.jsxs)(v.av,{value:"popular",className:"space-y-6",children:[(0,a.jsxs)(c.Zp,{children:[(0,a.jsx)(c.aR,{children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)(c.ZB,{className:"flex items-center",children:[(0,a.jsx)(u.A,{className:"h-5 w-5 mr-2 text-green-500"}),"Самые популярные адреса"]}),(0,a.jsx)(c.BT,{children:"Адреса с наибольшим количеством отзывов"})]}),(0,a.jsx)(f.$,{variant:"outline",size:"sm",asChild:!0,children:(0,a.jsx)(g(),{href:"/property",children:"Смотреть все"})})]})}),(0,a.jsx)(c.Wu,{children:(0,a.jsx)("div",{className:"grid gap-4",children:(null==_||null==(o=_.addresses)?void 0:o.length)===0?(0,a.jsxs)("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:[(0,a.jsx)(u.A,{className:"h-12 w-12 mx-auto mb-4 text-gray-300 dark:text-gray-600"}),(0,a.jsx)("p",{children:"Пока нет популярных адресов"})]}):null==_||null==(h=_.addresses)?void 0:h.slice(0,6).map((e,s)=>(0,a.jsx)(g(),{href:"/property?city=".concat(encodeURIComponent(e.city),"&street=").concat(encodeURIComponent(e.street),"&building=").concat(encodeURIComponent(e.building)),className:"block p-4 rounded-lg border hover:bg-gray-50 transition-colors",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"p-2 bg-green-100 rounded-full",children:(0,a.jsx)(u.A,{className:"h-4 w-4 text-green-500"})}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"font-medium",children:["#",s+1," ",e.street," ",e.building]}),(0,a.jsxs)("div",{className:"text-sm text-gray-500",children:[e.city,e.residentialComplex&&(0,a.jsxs)("span",{className:"ml-1",children:["• ",e.residentialComplex]})]})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsxs)(j.E,{variant:"secondary",children:[e.usageCount," отзывов"]}),(0,a.jsx)(b.A,{className:"h-4 w-4 text-gray-400"})]})]})},e._id))})})]}),(0,a.jsxs)(c.Zp,{children:[(0,a.jsxs)(c.aR,{children:[(0,a.jsxs)(c.ZB,{className:"flex items-center",children:[(0,a.jsx)(m.A,{className:"h-5 w-5 mr-2 text-purple-500"}),"Самые активные города"]}),(0,a.jsx)(c.BT,{children:"Города с наибольшей активностью пользователей"})]}),(0,a.jsx)(c.Wu,{children:(0,a.jsx)("div",{className:"grid gap-3",children:(null==_?void 0:_.addresses)&&Object.entries(_.addresses.reduce((e,s)=>(e[s.city]=(e[s.city]||0)+s.usageCount,e),{})).sort((e,s)=>{let[,r]=e,[,a]=s;return a-r}).slice(0,5).map((e,s)=>{let[r,t]=e;return(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg border",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"p-2 bg-purple-100 rounded-full",children:(0,a.jsxs)("span",{className:"text-purple-600 font-bold",children:["#",s+1]})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium",children:r}),(0,a.jsxs)("div",{className:"text-sm text-gray-500",children:[t," отзывов"]})]})]}),(0,a.jsx)(f.$,{variant:"outline",size:"sm",asChild:!0,children:(0,a.jsx)(g(),{href:"/property?city=".concat(encodeURIComponent(r)),children:"Смотреть"})})]},r)})})})]})]}),(0,a.jsxs)(v.av,{value:"high-rated",className:"space-y-6",children:[(0,a.jsxs)(c.Zp,{children:[(0,a.jsx)(c.aR,{children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)(c.ZB,{className:"flex items-center",children:[(0,a.jsx)(x.A,{className:"h-5 w-5 mr-2 text-yellow-500"}),"Отзывы с высоким рейтингом"]}),(0,a.jsx)(c.BT,{children:"Лучшие отзывы с рейтингом 4+ звезд"})]}),(0,a.jsx)(f.$,{variant:"outline",size:"sm",asChild:!0,children:(0,a.jsx)(g(),{href:"/property",children:"Смотреть все"})})]})}),(0,a.jsx)(c.Wu,{children:(0,a.jsx)("div",{className:"grid gap-4",children:(null==W?void 0:W.length)===0?(0,a.jsxs)("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:[(0,a.jsx)(x.A,{className:"h-12 w-12 mx-auto mb-4 text-gray-300 dark:text-gray-600"}),(0,a.jsx)("p",{children:"Пока нет отзывов с высоким рейтингом"})]}):null==W?void 0:W.slice(0,6).map(e=>(0,a.jsx)(g(),{href:"/property/".concat(e._id),className:"block p-4 rounded-lg border hover:bg-gray-50 transition-colors",children:(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,a.jsx)(y.A,{className:"h-4 w-4 text-gray-500"}),(0,a.jsxs)("span",{className:"font-medium",children:[e.street," ",e.building,","," ",e.city]}),(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)(x.A,{className:"h-4 w-4 text-yellow-500 fill-current"}),(0,a.jsx)("span",{className:"text-sm text-yellow-600 font-medium",children:e.rating})]})]}),(0,a.jsx)("p",{className:"text-sm text-gray-600 line-clamp-2",children:e.reviewText}),(0,a.jsxs)("div",{className:"flex items-center space-x-4 mt-2 text-xs text-gray-500",children:[(0,a.jsxs)("span",{children:[e.numberOfRooms," комнат"]}),(0,a.jsx)("span",{children:H(e.createdAt)}),(0,a.jsxs)("span",{children:[e.author.firstName," ",e.author.lastName]})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2 ml-4",children:[(0,a.jsx)(A.A,{className:"h-4 w-4 text-green-500"}),(0,a.jsx)(b.A,{className:"h-4 w-4 text-gray-400"})]})]})},e._id))})})]}),(0,a.jsxs)(c.Zp,{children:[(0,a.jsxs)(c.aR,{children:[(0,a.jsxs)(c.ZB,{className:"flex items-center",children:[(0,a.jsx)(u.A,{className:"h-5 w-5 mr-2 text-blue-500"}),"Статистика рейтингов"]}),(0,a.jsx)(c.BT,{children:"Распределение рейтингов по всем отзывам"})]}),(0,a.jsx)(c.Wu,{children:(0,a.jsx)("div",{className:"grid gap-3",children:[5,4,3,2,1].map(e=>{var s,r;let t=(null==T||null==(s=T.reviews)?void 0:s.filter(s=>s.rating===e).length)||0,l=(null==T||null==(r=T.reviews)?void 0:r.length)?Math.round(t/T.reviews.length*100):0;return(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-1 w-16",children:[(0,a.jsx)("span",{className:"text-sm font-medium",children:e}),(0,a.jsx)(x.A,{className:"h-4 w-4 text-yellow-500"})]}),(0,a.jsx)("div",{className:"flex-1 bg-gray-200 dark:bg-gray-700 rounded-full h-2",children:(0,a.jsx)("div",{className:"bg-yellow-500 h-2 rounded-full transition-all duration-300",style:{width:"".concat(l,"%")}})}),(0,a.jsx)("span",{className:"text-sm text-gray-600 dark:text-gray-300 w-12",children:t})]},e)})})})]})]})]})]})}):null}},7003:(e,s,r)=>{"use strict";r.d(s,{$:()=>d});var a=r(5155),t=r(2115),l=r(2467),n=r(3101),i=r(5016);let c=(0,n.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=t.forwardRef((e,s)=>{let{className:r,variant:t,size:n,asChild:d=!1,...o}=e,x=d?l.DX:"button";return(0,a.jsx)(x,{className:(0,i.cn)(c({variant:t,size:n,className:r})),ref:s,...o})});d.displayName="Button"},7621:(e,s,r)=>{"use strict";r.d(s,{FH:()=>l,G9:()=>i,hA:()=>n});var a=r(5125),t=r(5704);let l=a.A.create({baseURL:t.env.NEXT_PUBLIC_API_URL||"https://prokvartiru.kz/api",headers:{"Content-Type":"application/json"},withCredentials:!0});l.interceptors.request.use(e=>e,e=>Promise.reject(e)),l.interceptors.response.use(e=>e,e=>Promise.reject(e));let n={getRememberedAddresses:async function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,r=new URLSearchParams;return e&&r.append("city",e),r.append("limit",s.toString()),(await l.get("/addresses/remembered?".concat(r))).data},saveRememberedAddress:async e=>(await l.post("/addresses/remembered",e)).data,getPopularAddresses:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:20;return(await l.get("/addresses/popular?limit=".concat(e))).data},searchAddresses:async function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;return(await l.get("/addresses/search?q=".concat(encodeURIComponent(e),"&limit=").concat(s))).data}},i={getTrendingTopics:async()=>(await l.get("/recommendations/trending-topics")).data,getStats:async()=>(await l.get("/recommendations/stats")).data,getUserPreferences:async()=>(await l.get("/recommendations/user-preferences")).data}},7812:(e,s,r)=>{"use strict";r.d(s,{E:()=>i});var a=r(5155);r(2115);var t=r(3101),l=r(5016);let n=(0,t.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function i(e){let{className:s,variant:r,...t}=e;return(0,a.jsx)("div",{className:(0,l.cn)(n({variant:r}),s),...t})}}},e=>{e.O(0,[783,812,619,736,262,89,441,255,358],()=>e(e.s=5757)),_N_E=e.O()}]);