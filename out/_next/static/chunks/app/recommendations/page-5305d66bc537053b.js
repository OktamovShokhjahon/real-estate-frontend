(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[70],{7579:function(e,s,t){Promise.resolve().then(t.bind(t,8568))},8568:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return P}});var r=t(7437),a=t(2265),n=t(6484),l=t(8730),i=t(9116),c=t(6070),d=t(44),o=t(9205);let x=(0,o.Z)("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]);var m=t(6595),u=t(5805),h=t(525),g=t(7648);let f=e=>{switch(e){case"city":return(0,r.jsx)(d.Z,{className:"h-4 w-4"});case"room":return(0,r.jsx)(x,{className:"h-4 w-4"});case"rating":return(0,r.jsx)(m.Z,{className:"h-4 w-4"});case"recent":return(0,r.jsx)(u.Z,{className:"h-4 w-4"});default:return(0,r.jsx)(h.Z,{className:"h-4 w-4"})}},p=e=>{switch(e){case"city":return"bg-blue-100 text-blue-600 dark:bg-blue-900 dark:text-blue-400";case"room":return"bg-purple-100 text-purple-600 dark:bg-purple-900 dark:text-purple-400";case"rating":return"bg-yellow-100 text-yellow-600 dark:bg-yellow-900 dark:text-yellow-400";case"recent":return"bg-red-100 text-red-600 dark:bg-red-900 dark:text-red-400";default:return"bg-gray-100 text-gray-600 dark:bg-gray-900 dark:text-gray-400"}};function j(){let{data:e,isLoading:s,error:t}=(0,n.useQuery)(["trending-topics"],i.zy.getTrendingTopics);return s?(0,r.jsxs)(c.Zb,{children:[(0,r.jsx)(c.Ol,{children:(0,r.jsxs)(c.ll,{className:"flex items-center",children:[(0,r.jsx)(h.Z,{className:"h-5 w-5 mr-2 text-orange-500"}),"Трендовые темы"]})}),(0,r.jsx)(c.aY,{children:(0,r.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:[...Array(6)].map((e,s)=>(0,r.jsx)("div",{className:"p-3 rounded-lg border animate-pulse",children:(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("div",{className:"w-8 h-8 bg-gray-200 dark:bg-gray-700 rounded-full"}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded mb-1"}),(0,r.jsx)("div",{className:"h-3 bg-gray-200 dark:bg-gray-700 rounded w-16"})]})]})},s))})})]}):!t&&(null==e?void 0:e.trendingTopics)?(0,r.jsxs)(c.Zb,{children:[(0,r.jsx)(c.Ol,{children:(0,r.jsxs)(c.ll,{className:"flex items-center",children:[(0,r.jsx)(h.Z,{className:"h-5 w-5 mr-2 text-orange-500"}),"Трендовые темы"]})}),(0,r.jsx)(c.aY,{children:(0,r.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:e.trendingTopics.map(e=>(0,r.jsx)(g.default,{href:e.href,className:"block p-3 rounded-lg border hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",children:(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("div",{className:"p-2 rounded-full ".concat(p(e.type)),children:f(e.type)}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsx)("div",{className:"font-medium text-sm truncate dark:text-gray-200",children:e.name}),(0,r.jsxs)("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:[e.count," отзывов"]})]})]})},e.id))})})]}):(0,r.jsxs)(c.Zb,{children:[(0,r.jsx)(c.Ol,{children:(0,r.jsxs)(c.ll,{className:"flex items-center",children:[(0,r.jsx)(h.Z,{className:"h-5 w-5 mr-2 text-orange-500"}),"Трендовые темы"]})}),(0,r.jsx)(c.aY,{children:(0,r.jsxs)("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:[(0,r.jsx)(h.Z,{className:"h-12 w-12 mx-auto mb-4 text-gray-300 dark:text-gray-600"}),(0,r.jsx)("p",{children:"Не удалось загрузить трендовые темы"})]})})]})}var v=t(5974),y=t(2869),N=t(2339),b=t(3774),w=t(8997),Z=t(6858),k=t(1723);let C=(0,o.Z)("ThumbsUp",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2a3.13 3.13 0 0 1 3 3.88Z",key:"emmmcr"}]]);var R=t(9376);function P(){var e,s,t,o,x;let{user:f}=(0,l.a)(),p=(0,R.useRouter)(),[P,z]=(0,a.useState)(null),{data:A,isLoading:U}=(0,n.useQuery)(["recent-reviews"],async()=>(await i.hi.get("/property/reviews?limit=8")).data),{data:S,isLoading:_}=(0,n.useQuery)(["popular-addresses"],async()=>(await i.PH.getPopularAddresses(8)).data),{data:O,isLoading:Y}=(0,n.useQuery)(["high-rated-reviews"],async()=>((await i.hi.get("/property/reviews?limit=6")).data.reviews||[]).filter(e=>"number"==typeof e.rating&&e.rating>=4)),{data:L}=(0,n.useQuery)(["user-preferences",null==f?void 0:f.email],i.zy.getUserPreferences,{enabled:!!f}),{data:T,isLoading:I}=(0,n.useQuery)(["recommendation-stats"],i.zy.getStats);(0,a.useEffect)(()=>{if(T)z(T);else if(A&&S){let e=A.reviews||[],s=S.addresses||[],t=e.reduce((e,s)=>e+(s.rating||0),0),r=e.length>0?t/e.length:0,a={};s.forEach(e=>{a[e.city]=(a[e.city]||0)+e.usageCount});let n=Object.keys(a).reduce((e,s)=>a[e]>a[s]?e:s)||"Неизвестно";z({totalReviews:e.length,totalAddresses:s.length,averageRating:Math.round(10*r)/10,mostPopularCity:n})}},[T,A,S]);let E=e=>new Date(e).toLocaleDateString("ru-RU",{year:"numeric",month:"long",day:"numeric"}),M=e=>e>=4?"text-green-600":e>=3?"text-yellow-600":"text-red-600";return(a.useEffect(()=>{f||p.push("/login")},[f,p]),f)?U||_||Y||I?(0,r.jsxs)("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold mb-2",children:"Рекомендации для вас"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Персонализированные рекомендации на основе ваших предпочтений и популярного контента"})]}),(0,r.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Загрузка рекомендаций..."})]})})]}):(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold mb-2 dark:text-white",children:"Рекомендации для вас"}),(0,r.jsx)("p",{className:"text-gray-600 dark:text-gray-300",children:"Персонализированные рекомендации на основе ваших предпочтений и популярного контента"})]}),P&&(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-8",children:[(0,r.jsx)(c.Zb,{children:(0,r.jsx)(c.aY,{className:"p-4",children:(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(d.Z,{className:"h-5 w-5 text-blue-600"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:"Всего отзывов"}),(0,r.jsx)("p",{className:"text-2xl font-bold dark:text-white",children:P.totalReviews})]})]})})}),(0,r.jsx)(c.Zb,{children:(0,r.jsx)(c.aY,{className:"p-4",children:(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(b.Z,{className:"h-5 w-5 text-green-600"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:"Популярных адресов"}),(0,r.jsx)("p",{className:"text-2xl font-bold dark:text-white",children:P.totalAddresses})]})]})})}),(0,r.jsx)(c.Zb,{children:(0,r.jsx)(c.aY,{className:"p-4",children:(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(m.Z,{className:"h-5 w-5 text-yellow-600"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:"Средний рейтинг"}),(0,r.jsx)("p",{className:"text-2xl font-bold dark:text-white",children:P.averageRating})]})]})})}),(0,r.jsx)(c.Zb,{children:(0,r.jsx)(c.aY,{className:"p-4",children:(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(h.Z,{className:"h-5 w-5 text-purple-600"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:"Популярный город"}),(0,r.jsx)("p",{className:"text-2xl font-bold dark:text-white",children:P.mostPopularCity})]})]})})})]}),(0,r.jsxs)(N.mQ,{defaultValue:"recommended",className:"space-y-6",children:[(0,r.jsxs)(N.dr,{className:"grid w-full grid-cols-3",children:[(0,r.jsxs)(N.SP,{value:"recommended",className:"flex items-center space-x-2",children:[(0,r.jsx)(w.Z,{className:"h-4 w-4"}),(0,r.jsx)("span",{children:"Рекомендуемое"})]}),(0,r.jsxs)(N.SP,{value:"popular",className:"flex items-center space-x-2",children:[(0,r.jsx)(h.Z,{className:"h-4 w-4"}),(0,r.jsx)("span",{children:"Популярное"})]}),(0,r.jsxs)(N.SP,{value:"high-rated",className:"flex items-center space-x-2",children:[(0,r.jsx)(m.Z,{className:"h-4 w-4"}),(0,r.jsx)("span",{children:"Высокий рейтинг"})]})]}),(0,r.jsxs)(N.nU,{value:"recommended",className:"space-y-6",children:[(0,r.jsx)(j,{}),L&&(0,r.jsxs)(c.Zb,{children:[(0,r.jsxs)(c.Ol,{children:[(0,r.jsxs)(c.ll,{className:"flex items-center",children:[(0,r.jsx)(w.Z,{className:"h-5 w-5 mr-2 text-red-500"}),"Основано на ваших предпочтениях"]}),(0,r.jsxs)(c.SZ,{children:["Рекомендации на основе вашего города:"," ",L.preferredCity]})]}),(0,r.jsx)(c.aY,{children:(0,r.jsx)("div",{className:"grid gap-4",children:null==S?void 0:null===(e=S.addresses)||void 0===e?void 0:e.filter(e=>e.city===L.preferredCity).slice(0,4).map(e=>(0,r.jsx)(g.default,{href:"/property?city=".concat(encodeURIComponent(e.city),"&street=").concat(encodeURIComponent(e.street),"&building=").concat(encodeURIComponent(e.building)),className:"block p-4 rounded-lg border hover:bg-gray-50 transition-colors",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)("div",{className:"p-2 bg-red-100 rounded-full",children:(0,r.jsx)(w.Z,{className:"h-4 w-4 text-red-500"})}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"font-medium",children:[e.street," ",e.building]}),(0,r.jsxs)("div",{className:"text-sm text-gray-500",children:[e.city,e.residentialComplex&&(0,r.jsxs)("span",{className:"ml-1",children:["• ",e.residentialComplex]})]})]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsxs)(v.C,{variant:"secondary",children:[e.usageCount," отзывов"]}),(0,r.jsx)(Z.Z,{className:"h-4 w-4 text-gray-400"})]})]})},e._id))})})]}),(0,r.jsxs)(c.Zb,{children:[(0,r.jsx)(c.Ol,{children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)(c.ll,{className:"flex items-center",children:[(0,r.jsx)(k.Z,{className:"h-5 w-5 mr-2 text-blue-500"}),"Недавние отзывы"]}),(0,r.jsx)(c.SZ,{children:"Последние отзывы, которые могут вас заинтересовать"})]}),(0,r.jsx)(y.z,{variant:"outline",size:"sm",asChild:!0,children:(0,r.jsx)(g.default,{href:"/property",children:"Смотреть все"})})]})}),(0,r.jsx)(c.aY,{children:(0,r.jsx)("div",{className:"grid gap-4",children:(null==A?void 0:null===(s=A.reviews)||void 0===s?void 0:s.length)===0?(0,r.jsxs)("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:[(0,r.jsx)(k.Z,{className:"h-12 w-12 mx-auto mb-4 text-gray-300 dark:text-gray-600"}),(0,r.jsx)("p",{children:"Пока нет отзывов"})]}):null==A?void 0:null===(t=A.reviews)||void 0===t?void 0:t.slice(0,4).map(e=>(0,r.jsx)(g.default,{href:"/property/".concat(e._id),className:"block p-4 rounded-lg border hover:bg-gray-50 transition-colors",children:(0,r.jsxs)("div",{className:"flex items-start justify-between",children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,r.jsx)(b.Z,{className:"h-4 w-4 text-gray-500"}),(0,r.jsxs)("span",{className:"font-medium",children:[e.street," ",e.building,","," ",e.city]}),"number"==typeof e.rating&&(0,r.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,r.jsx)(m.Z,{className:"h-4 w-4 ".concat(M(e.rating))}),(0,r.jsx)("span",{className:"text-sm ".concat(M(e.rating)),children:e.rating})]})]}),(0,r.jsx)("p",{className:"text-sm text-gray-600 line-clamp-2",children:e.reviewText}),(0,r.jsxs)("div",{className:"flex items-center space-x-4 mt-2 text-xs text-gray-500",children:[(0,r.jsxs)("span",{children:[e.numberOfRooms," комнат"]}),(0,r.jsx)("span",{children:E(e.createdAt)}),(0,r.jsxs)("span",{children:[e.author.firstName," ",e.author.lastName]})]})]}),(0,r.jsx)(Z.Z,{className:"h-4 w-4 text-gray-400 ml-4"})]})},e._id))})})]})]}),(0,r.jsxs)(N.nU,{value:"popular",className:"space-y-6",children:[(0,r.jsxs)(c.Zb,{children:[(0,r.jsx)(c.Ol,{children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)(c.ll,{className:"flex items-center",children:[(0,r.jsx)(h.Z,{className:"h-5 w-5 mr-2 text-green-500"}),"Самые популярные адреса"]}),(0,r.jsx)(c.SZ,{children:"Адреса с наибольшим количеством отзывов"})]}),(0,r.jsx)(y.z,{variant:"outline",size:"sm",asChild:!0,children:(0,r.jsx)(g.default,{href:"/property",children:"Смотреть все"})})]})}),(0,r.jsx)(c.aY,{children:(0,r.jsx)("div",{className:"grid gap-4",children:(null==S?void 0:null===(o=S.addresses)||void 0===o?void 0:o.length)===0?(0,r.jsxs)("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:[(0,r.jsx)(h.Z,{className:"h-12 w-12 mx-auto mb-4 text-gray-300 dark:text-gray-600"}),(0,r.jsx)("p",{children:"Пока нет популярных адресов"})]}):null==S?void 0:null===(x=S.addresses)||void 0===x?void 0:x.slice(0,6).map((e,s)=>(0,r.jsx)(g.default,{href:"/property?city=".concat(encodeURIComponent(e.city),"&street=").concat(encodeURIComponent(e.street),"&building=").concat(encodeURIComponent(e.building)),className:"block p-4 rounded-lg border hover:bg-gray-50 transition-colors",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)("div",{className:"p-2 bg-green-100 rounded-full",children:(0,r.jsx)(h.Z,{className:"h-4 w-4 text-green-500"})}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"font-medium",children:["#",s+1," ",e.street," ",e.building]}),(0,r.jsxs)("div",{className:"text-sm text-gray-500",children:[e.city,e.residentialComplex&&(0,r.jsxs)("span",{className:"ml-1",children:["• ",e.residentialComplex]})]})]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsxs)(v.C,{variant:"secondary",children:[e.usageCount," отзывов"]}),(0,r.jsx)(Z.Z,{className:"h-4 w-4 text-gray-400"})]})]})},e._id))})})]}),(0,r.jsxs)(c.Zb,{children:[(0,r.jsxs)(c.Ol,{children:[(0,r.jsxs)(c.ll,{className:"flex items-center",children:[(0,r.jsx)(u.Z,{className:"h-5 w-5 mr-2 text-purple-500"}),"Самые активные города"]}),(0,r.jsx)(c.SZ,{children:"Города с наибольшей активностью пользователей"})]}),(0,r.jsx)(c.aY,{children:(0,r.jsx)("div",{className:"grid gap-3",children:(null==S?void 0:S.addresses)&&Object.entries(S.addresses.reduce((e,s)=>(e[s.city]=(e[s.city]||0)+s.usageCount,e),{})).sort((e,s)=>{let[,t]=e,[,r]=s;return r-t}).slice(0,5).map((e,s)=>{let[t,a]=e;return(0,r.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg border",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)("div",{className:"p-2 bg-purple-100 rounded-full",children:(0,r.jsxs)("span",{className:"text-purple-600 font-bold",children:["#",s+1]})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"font-medium",children:t}),(0,r.jsxs)("div",{className:"text-sm text-gray-500",children:[a," отзывов"]})]})]}),(0,r.jsx)(y.z,{variant:"outline",size:"sm",asChild:!0,children:(0,r.jsx)(g.default,{href:"/property?city=".concat(encodeURIComponent(t)),children:"Смотреть"})})]},t)})})})]})]}),(0,r.jsxs)(N.nU,{value:"high-rated",className:"space-y-6",children:[(0,r.jsxs)(c.Zb,{children:[(0,r.jsx)(c.Ol,{children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)(c.ll,{className:"flex items-center",children:[(0,r.jsx)(m.Z,{className:"h-5 w-5 mr-2 text-yellow-500"}),"Отзывы с высоким рейтингом"]}),(0,r.jsx)(c.SZ,{children:"Лучшие отзывы с рейтингом 4+ звезд"})]}),(0,r.jsx)(y.z,{variant:"outline",size:"sm",asChild:!0,children:(0,r.jsx)(g.default,{href:"/property",children:"Смотреть все"})})]})}),(0,r.jsx)(c.aY,{children:(0,r.jsx)("div",{className:"grid gap-4",children:(null==O?void 0:O.length)===0?(0,r.jsxs)("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:[(0,r.jsx)(m.Z,{className:"h-12 w-12 mx-auto mb-4 text-gray-300 dark:text-gray-600"}),(0,r.jsx)("p",{children:"Пока нет отзывов с высоким рейтингом"})]}):null==O?void 0:O.slice(0,6).map(e=>(0,r.jsx)(g.default,{href:"/property/".concat(e._id),className:"block p-4 rounded-lg border hover:bg-gray-50 transition-colors",children:(0,r.jsxs)("div",{className:"flex items-start justify-between",children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,r.jsx)(b.Z,{className:"h-4 w-4 text-gray-500"}),(0,r.jsxs)("span",{className:"font-medium",children:[e.street," ",e.building,","," ",e.city]}),(0,r.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,r.jsx)(m.Z,{className:"h-4 w-4 text-yellow-500 fill-current"}),(0,r.jsx)("span",{className:"text-sm text-yellow-600 font-medium",children:e.rating})]})]}),(0,r.jsx)("p",{className:"text-sm text-gray-600 line-clamp-2",children:e.reviewText}),(0,r.jsxs)("div",{className:"flex items-center space-x-4 mt-2 text-xs text-gray-500",children:[(0,r.jsxs)("span",{children:[e.numberOfRooms," комнат"]}),(0,r.jsx)("span",{children:E(e.createdAt)}),(0,r.jsxs)("span",{children:[e.author.firstName," ",e.author.lastName]})]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2 ml-4",children:[(0,r.jsx)(C,{className:"h-4 w-4 text-green-500"}),(0,r.jsx)(Z.Z,{className:"h-4 w-4 text-gray-400"})]})]})},e._id))})})]}),(0,r.jsxs)(c.Zb,{children:[(0,r.jsxs)(c.Ol,{children:[(0,r.jsxs)(c.ll,{className:"flex items-center",children:[(0,r.jsx)(h.Z,{className:"h-5 w-5 mr-2 text-blue-500"}),"Статистика рейтингов"]}),(0,r.jsx)(c.SZ,{children:"Распределение рейтингов по всем отзывам"})]}),(0,r.jsx)(c.aY,{children:(0,r.jsx)("div",{className:"grid gap-3",children:[5,4,3,2,1].map(e=>{var s,t;let a=(null==A?void 0:null===(s=A.reviews)||void 0===s?void 0:s.filter(s=>s.rating===e).length)||0,n=(null==A?void 0:null===(t=A.reviews)||void 0===t?void 0:t.length)?Math.round(a/A.reviews.length*100):0;return(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-1 w-16",children:[(0,r.jsx)("span",{className:"text-sm font-medium",children:e}),(0,r.jsx)(m.Z,{className:"h-4 w-4 text-yellow-500"})]}),(0,r.jsx)("div",{className:"flex-1 bg-gray-200 dark:bg-gray-700 rounded-full h-2",children:(0,r.jsx)("div",{className:"bg-yellow-500 h-2 rounded-full transition-all duration-300",style:{width:"".concat(n,"%")}})}),(0,r.jsx)("span",{className:"text-sm text-gray-600 dark:text-gray-300 w-12",children:a})]},e)})})})]})]})]})]})}):null}},5974:function(e,s,t){"use strict";t.d(s,{C:function(){return i}});var r=t(7437);t(2265);var a=t(535),n=t(4508);let l=(0,a.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function i(e){let{className:s,variant:t,...a}=e;return(0,r.jsx)("div",{className:(0,n.cn)(l({variant:t}),s),...a})}},2869:function(e,s,t){"use strict";t.d(s,{z:function(){return d}});var r=t(7437),a=t(2265),n=t(7053),l=t(535),i=t(4508);let c=(0,l.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=a.forwardRef((e,s)=>{let{className:t,variant:a,size:l,asChild:d=!1,...o}=e,x=d?n.g7:"button";return(0,r.jsx)(x,{className:(0,i.cn)(c({variant:a,size:l,className:t})),ref:s,...o})});d.displayName="Button"},6070:function(e,s,t){"use strict";t.d(s,{Ol:function(){return i},SZ:function(){return d},Zb:function(){return l},aY:function(){return o},ll:function(){return c}});var r=t(7437),a=t(2265),n=t(4508);let l=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)("div",{ref:s,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",t),...a})});l.displayName="Card";let i=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)("div",{ref:s,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",t),...a})});i.displayName="CardHeader";let c=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)("div",{ref:s,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",t),...a})});c.displayName="CardTitle";let d=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)("div",{ref:s,className:(0,n.cn)("text-sm text-muted-foreground",t),...a})});d.displayName="CardDescription";let o=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)("div",{ref:s,className:(0,n.cn)("p-6 pt-0",t),...a})});o.displayName="CardContent",a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)("div",{ref:s,className:(0,n.cn)("flex items-center p-6 pt-0",t),...a})}).displayName="CardFooter"},2339:function(e,s,t){"use strict";t.d(s,{SP:function(){return d},dr:function(){return c},mQ:function(){return i},nU:function(){return o}});var r=t(7437),a=t(2265),n=t(271),l=t(4508);let i=n.fC,c=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)(n.aV,{ref:s,className:(0,l.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",t),...a})});c.displayName=n.aV.displayName;let d=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)(n.xz,{ref:s,className:(0,l.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",t),...a})});d.displayName=n.xz.displayName;let o=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)(n.VY,{ref:s,className:(0,l.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...a})});o.displayName=n.VY.displayName},8730:function(e,s,t){"use strict";t.d(s,{H:function(){return o},a:function(){return x}});var r=t(7437),a=t(2265),n=t(9376),l=t(4131),i=t(9116),c=t(9064);let d=(0,a.createContext)(void 0);function o(e){let{children:s}=e,[t,o]=(0,a.useState)(null),[x,m]=(0,a.useState)(!0),u=(0,n.useRouter)();(0,a.useEffect)(()=>{let e=l.Z.get("token");e?(i.hi.defaults.headers.common.Authorization="Bearer ".concat(e),h()):m(!1)},[]);let h=async()=>{try{let e=await i.hi.get("/auth/me");o(e.data.user)}catch(e){l.Z.remove("token"),delete i.hi.defaults.headers.common.Authorization}finally{m(!1)}},g=async(e,s)=>{try{let{token:t,user:r}=(await i.hi.post("/auth/login",{email:e,password:s})).data;l.Z.set("token",t,{expires:7}),i.hi.defaults.headers.common.Authorization="Bearer ".concat(t),o(r),c.ZP.success("Вход выполнен успешно!"),u.push("/dashboard")}catch(e){var t,r;throw c.ZP.error((null===(r=e.response)||void 0===r?void 0:null===(t=r.data)||void 0===t?void 0:t.message)||"Ошибка входа"),e}},f=async e=>{try{let{user:s}=(await i.hi.post("/auth/register",e)).data;c.ZP.success("Код подтверждения отправлен на ваш email. Пожалуйста, введите его для завершения регистрации."),u.push("/verify-email/verify?email=".concat(encodeURIComponent(s.email)))}catch(e){var s,t;throw c.ZP.error((null===(t=e.response)||void 0===t?void 0:null===(s=t.data)||void 0===s?void 0:s.message)||"Ошибка регистрации"),e}},p=async(e,s)=>{try{await i.hi.post("/auth/verify-email",{email:e,code:s}),c.ZP.success("Email успешно подтвержден!"),t?await h():u.push("/login")}catch(e){var r,a;throw c.ZP.error((null===(a=e.response)||void 0===a?void 0:null===(r=a.data)||void 0===r?void 0:r.message)||"Ошибка подтверждения email"),e}};return(0,r.jsx)(d.Provider,{value:{user:t,login:g,register:f,verifyEmail:p,logout:()=>{l.Z.remove("token"),delete i.hi.defaults.headers.common.Authorization,o(null),c.ZP.success("Вы успешно вышли из системы"),u.push("/")},loading:x},children:s})}function x(){let e=(0,a.useContext)(d);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},9116:function(e,s,t){"use strict";t.d(s,{PH:function(){return l},hi:function(){return n},zy:function(){return i}});var r=t(3464),a=t(257);let n=r.Z.create({baseURL:a.env.NEXT_PUBLIC_API_URL||"http://localhost:4100/api",headers:{"Content-Type":"application/json"}});n.interceptors.request.use(e=>e,e=>Promise.reject(e)),n.interceptors.response.use(e=>e,e=>{var s;return(null===(s=e.response)||void 0===s?void 0:s.status)===401&&(window.location.href="/login"),Promise.reject(e)});let l={getRememberedAddresses:async function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,t=new URLSearchParams;return e&&t.append("city",e),t.append("limit",s.toString()),(await n.get("/addresses/remembered?".concat(t))).data},saveRememberedAddress:async e=>(await n.post("/addresses/remembered",e)).data,getPopularAddresses:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:20;return(await n.get("/addresses/popular?limit=".concat(e))).data},searchAddresses:async function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;return(await n.get("/addresses/search?q=".concat(encodeURIComponent(e),"&limit=").concat(s))).data}},i={getTrendingTopics:async()=>(await n.get("/recommendations/trending-topics")).data,getStats:async()=>(await n.get("/recommendations/stats")).data,getUserPreferences:async()=>(await n.get("/recommendations/user-preferences")).data}},4508:function(e,s,t){"use strict";t.d(s,{cn:function(){return n}});var r=t(1994),a=t(3335);function n(){for(var e=arguments.length,s=Array(e),t=0;t<e;t++)s[t]=arguments[t];return(0,a.m6)((0,r.W)(s))}},6858:function(e,s,t){"use strict";t.d(s,{Z:function(){return r}});let r=(0,t(9205).Z)("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]])},8997:function(e,s,t){"use strict";t.d(s,{Z:function(){return r}});let r=(0,t(9205).Z)("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]])},6595:function(e,s,t){"use strict";t.d(s,{Z:function(){return r}});let r=(0,t(9205).Z)("Star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]])}},function(e){e.O(0,[72,278,648,634,23,971,117,744],function(){return e(e.s=7579)}),_N_E=e.O()}]);