(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[626],{5391:function(e,t,r){Promise.resolve().then(r.bind(r,7566))},7566:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return w}});var a=r(7437),n=r(2265),i=r(7648),s=r(8730),o=r(2869),d=r(5186),l=r(6815),u=r(6070);let c="\\u0400-\\u04FF\\u0500-\\u052F\\u2DE0-\\u2DFF\\uA640-\\uA69F\\u1C80-\\u1C8F",m={email:/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,password:/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[a-zA-Z\d@$!%*?&]{8,}$/,name:new RegExp("^[a-zA-Z".concat(c,"\\s\\-']{2,50}$")),city:new RegExp("^[a-zA-Z".concat(c,"\\s\\-.]{2,100}$")),street:new RegExp("^[a-zA-Z".concat(c,"0-9\\s\\-.,']{2,200}$")),building:new RegExp("^[a-zA-Z".concat(c,"0-9\\s\\-.,'/]{1,50}$")),apartmentNumber:/^[a-zA-Z0-9-]{1,20}$/,floor:/^-?[0-9]{1,3}$/,phone:/^[+]?[1-9][\d]{0,15}$/,phoneLastFour:/^[0-9]{4}$/,idLastFour:/^[0-9]{4}$/,landlordName:new RegExp("^[a-zA-Z".concat(c,"\\s\\-.']{2,100}$")),reviewText:new RegExp("^[\\w".concat(c,"\\s.,!?;:\\-'\"$$$$[\\]/&%$#@+=*]{10,5000}$")),rating:/^[1-5]$/,year:new RegExp("^(19[0-9]{2}|20[0-9]{2}|".concat(new Date().getFullYear()+1,")$")),month:/^(1[0-2]|[1-9])$/,numberOfRooms:/^[1-8]$/,searchQuery:new RegExp("^[a-zA-Z".concat(c,"0-9\\s\\-']{1,100}$")),commentText:new RegExp("^[\\w".concat(c,"\\s.,!?;:\\-'\"$$$$[\\]/&%$#@+=*]{1,1000}$")),tenantFullName:new RegExp("^[a-zA-Z".concat(c,"\\s\\-'.]{2,100}$")),url:/^https?:\/\/(www\.)?[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_+.~#?&//=]*)$/,username:/^[a-zA-Z0-9_-]{3,30}$/,postalCode:/^[a-zA-Z0-9\s-]{3,10}$/,hexColor:/^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/},f={isValidEmail:e=>m.email.test(e),isValidPassword:e=>m.password.test(e),isValidName:e=>m.name.test(e),isValidCity:e=>m.city.test(e),isValidStreet:e=>m.street.test(e),isValidBuilding:e=>m.building.test(e),isValidApartmentNumber:e=>m.apartmentNumber.test(e),isValidFloor:e=>m.floor.test(e.toString()),isValidPhone:e=>m.phone.test(e),isValidPhoneLastFour:e=>m.phoneLastFour.test(e),isValidIdLastFour:e=>m.idLastFour.test(e),isValidLandlordName:e=>m.landlordName.test(e),isValidReviewText:e=>m.reviewText.test(e),isValidRating:e=>m.rating.test(e.toString()),isValidYear:e=>m.year.test(e.toString()),isValidMonth:e=>m.month.test(e.toString()),isValidNumberOfRooms:e=>m.numberOfRooms.test(e.toString()),isValidUrl:e=>m.url.test(e),isValidUsername:e=>m.username.test(e),isValidPostalCode:e=>m.postalCode.test(e),isValidHexColor:e=>m.hexColor.test(e),isValidTenantFullName:e=>m.tenantFullName.test(e),isValidSearchQuery:e=>m.searchQuery.test(e),isValidCommentText:e=>m.commentText.test(e)},p=e=>"string"!=typeof e?"":e.trim().toLowerCase().substring(0,254),h={email:{required:"Email обязателен",invalid:"Пожалуйста, введите корректный email адрес"},password:{required:"Пароль обязателен",invalid:"Пароль должен содержать минимум 8 символов с заглавными буквами, строчными буквами и цифрами",minLength:"Пароль должен содержать минимум 8 символов"},name:{required:"Имя обязательно",invalid:"Имя может содержать только буквы, пробелы, дефисы и апострофы",minLength:"Имя должно содержать минимум 2 символа",maxLength:"Имя не должно превышать 50 символов"},city:{required:"Город обязателен",invalid:"Название города содержит недопустимые символы",minLength:"Название города должно содержать минимум 2 символа",maxLength:"Название города не должно превышать 100 символов"},street:{required:"Улица обязательна",invalid:"Название улицы содержит недопустимые символы",minLength:"Название улицы должно содержать минимум 2 символа",maxLength:"Название улицы не должно превышать 200 символов"},building:{required:"Здание обязательно",invalid:"Название/номер здания содержит недопустимые символы",minLength:"Здание должно содержать минимум 1 символ",maxLength:"Здание не должно превышать 50 символов"},apartmentNumber:{invalid:"Номер квартиры содержит недопустимые символы",maxLength:"Номер квартиры не должен превышать 20 символов"},floor:{invalid:"Этаж должен быть корректным числом"},phoneLastFour:{required:"Последние четыре цифры телефона обязательны",invalid:"Последние четыре цифры телефона должны быть ровно 4 цифрами"},idLastFour:{required:"Последние четыре цифры ID обязательны",invalid:"Последние четыре цифры ID должны быть ровно 4 цифрами"},landlordName:{required:"Имя арендодателя обязательно",invalid:"Имя арендодателя содержит недопустимые символы",minLength:"Имя арендодателя должно содержать минимум 2 символа",maxLength:"Имя арендодателя не должно превышать 100 символов"},reviewText:{required:"Текст отзыва обязателен",invalid:"Текст отзыва содержит недопустимые символы",minLength:"Текст отзыва должен содержать минимум 10 символов",maxLength:"Текст отзыва не должен превышать 5000 символов"},rating:{invalid:"Рейтинг должен быть от 1 до 5"},year:{required:"Год обязателен",invalid:"Пожалуйста, введите корректный год"},month:{required:"Месяц обязателен",invalid:"Пожалуйста, выберите корректный месяц"},numberOfRooms:{required:"Количество комнат обязательно",invalid:"Количество комнат должно быть от 1 до 8"},tenantFullName:{required:"Полное имя арендатора обязательно",invalid:"Полное имя арендатора содержит недопустимые символы",minLength:"Полное имя арендатора должно содержать минимум 2 символа",maxLength:"Полное имя арендатора не должно превышать 100 символов"},commentText:{required:"Текст комментария обязателен",invalid:"Текст комментария содержит недопустимые символы",minLength:"Комментарий должен содержать минимум 1 символ",maxLength:"Комментарий не должен превышать 1000 символов"},searchQuery:{invalid:"Поисковый запрос содержит недопустимые символы",maxLength:"Поисковый запрос не должен превышать 100 символов"}},g=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=h[t];if(r&&(!e||""===e.trim()))return a&&"required"in a?a.required:"This field is required";if(!e||""===e.trim())return null;let n=f["isValid".concat(t.charAt(0).toUpperCase()+t.slice(1))];return n&&!n(e)?a.invalid||"Invalid format":null},v=(e,t)=>{let r={};for(let[a,n]of Object.entries(t)){let t=g(e[a],n.type,n.required);t&&(r[a]=t)}return r};var x=r(9376);function w(){let[e,t]=(0,n.useState)({email:"",password:""}),[r,c]=(0,n.useState)({}),[m,f]=(0,n.useState)(!1),{login:h}=(0,s.a)();(0,x.useRouter)();let g={email:{type:"email",required:!0},password:{type:"password",required:!0}},w=async t=>{t.preventDefault();let r={email:p(e.email),password:e.password},a=v(r,g);if(Object.keys(a).length>0){c(a);return}c({}),f(!0);try{await h(r.email,r.password)}catch(e){}finally{f(!1)}},b=e=>{let{name:a,value:n}=e.target;t(e=>({...e,[a]:n})),r[a]&&c(e=>({...e,[a]:""}))};return(0,a.jsx)("div",{className:"max-w-md mx-auto mt-16",children:(0,a.jsxs)(u.Zb,{children:[(0,a.jsxs)(u.Ol,{children:[(0,a.jsx)(u.ll,{children:"Вход"}),(0,a.jsx)(u.SZ,{children:"Введите ваши учетные данные для доступа к аккаунту"})]}),(0,a.jsxs)(u.aY,{children:[(0,a.jsxs)("form",{onSubmit:w,className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(l._,{htmlFor:"email",children:"Email"}),(0,a.jsx)(d.I,{id:"email",name:"email",type:"email",value:e.email,onChange:b,required:!0,className:r.email?"border-red-500":""}),r.email&&(0,a.jsx)("p",{className:"text-sm text-red-600",children:r.email})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(l._,{htmlFor:"password",children:"Пароль"}),(0,a.jsx)(d.I,{id:"password",name:"password",type:"password",value:e.password,onChange:b,required:!0,className:r.password?"border-red-500":""}),r.password&&(0,a.jsx)("p",{className:"text-sm text-red-600",children:r.password})]}),(0,a.jsx)(o.z,{type:"submit",className:"w-full",disabled:m,children:m?"Вход...":"Войти"})]}),(0,a.jsxs)("div",{className:"mt-4 text-center text-sm",children:["Нет аккаунта? ",(0,a.jsx)(i.default,{href:"/register",className:"text-blue-600 hover:underline",children:"Зарегистрироваться"})]})]})]})})}},2869:function(e,t,r){"use strict";r.d(t,{z:function(){return l}});var a=r(7437),n=r(2265),i=r(7495),s=r(535),o=r(4508);let d=(0,s.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),l=n.forwardRef((e,t)=>{let{className:r,variant:n,size:s,asChild:l=!1,...u}=e,c=l?i.g7:"button";return(0,a.jsx)(c,{className:(0,o.cn)(d({variant:n,size:s,className:r})),ref:t,...u})});l.displayName="Button"},6070:function(e,t,r){"use strict";r.d(t,{Ol:function(){return o},SZ:function(){return l},Zb:function(){return s},aY:function(){return u},ll:function(){return d}});var a=r(7437),n=r(2265),i=r(4508);let s=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,i.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",r),...n})});s.displayName="Card";let o=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",r),...n})});o.displayName="CardHeader";let d=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,i.cn)("text-2xl font-semibold leading-none tracking-tight",r),...n})});d.displayName="CardTitle";let l=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,i.cn)("text-sm text-muted-foreground",r),...n})});l.displayName="CardDescription";let u=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,i.cn)("p-6 pt-0",r),...n})});u.displayName="CardContent",n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,i.cn)("flex items-center p-6 pt-0",r),...n})}).displayName="CardFooter"},5186:function(e,t,r){"use strict";r.d(t,{I:function(){return s}});var a=r(7437),n=r(2265),i=r(4508);let s=n.forwardRef((e,t)=>{let{className:r,type:n,error:s,...o}=e;return(0,a.jsx)("input",{type:n,className:(0,i.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s&&"border-red-500 focus-visible:ring-red-500",r),ref:t,...o})});s.displayName="Input"},6815:function(e,t,r){"use strict";r.d(t,{_:function(){return l}});var a=r(7437),n=r(2265),i=r(6394),s=r(535),o=r(4508);let d=(0,s.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),l=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)(i.f,{ref:t,className:(0,o.cn)(d(),r),...n})});l.displayName=i.f.displayName},8730:function(e,t,r){"use strict";r.d(t,{H:function(){return u},a:function(){return c}});var a=r(7437),n=r(2265),i=r(9376),s=r(4131),o=r(9116),d=r(9064);let l=(0,n.createContext)(void 0);function u(e){let{children:t}=e,[r,u]=(0,n.useState)(null),[c,m]=(0,n.useState)(!0),f=(0,i.useRouter)();(0,n.useEffect)(()=>{let e=s.Z.get("token");e?(o.hi.defaults.headers.common.Authorization="Bearer ".concat(e),p()):m(!1)},[]);let p=async()=>{try{let e=await o.hi.get("/auth/me");u(e.data.user)}catch(e){s.Z.remove("token"),delete o.hi.defaults.headers.common.Authorization}finally{m(!1)}},h=async(e,t)=>{try{let{token:r,user:a}=(await o.hi.post("/auth/login",{email:e,password:t})).data;s.Z.set("token",r,{expires:7}),o.hi.defaults.headers.common.Authorization="Bearer ".concat(r),u(a),d.ZP.success("Вход выполнен успешно!"),f.push("/dashboard")}catch(e){var r,a;throw d.ZP.error((null===(a=e.response)||void 0===a?void 0:null===(r=a.data)||void 0===r?void 0:r.message)||"Ошибка входа"),e}},g=async e=>{try{let{user:t}=(await o.hi.post("/auth/register",e)).data;d.ZP.success("Код подтверждения отправлен на ваш email. Пожалуйста, введите его для завершения регистрации."),f.push("/verify-email/verify?email=".concat(encodeURIComponent(t.email)))}catch(e){var t,r;throw d.ZP.error((null===(r=e.response)||void 0===r?void 0:null===(t=r.data)||void 0===t?void 0:t.message)||"Ошибка регистрации"),e}},v=async(e,t)=>{try{await o.hi.post("/auth/verify-email",{email:e,code:t}),d.ZP.success("Email успешно подтвержден!"),r?await p():f.push("/login")}catch(e){var a,n;throw d.ZP.error((null===(n=e.response)||void 0===n?void 0:null===(a=n.data)||void 0===a?void 0:a.message)||"Ошибка подтверждения email"),e}};return(0,a.jsx)(l.Provider,{value:{user:r,login:h,register:g,verifyEmail:v,logout:()=>{s.Z.remove("token"),delete o.hi.defaults.headers.common.Authorization,u(null),d.ZP.success("Вы успешно вышли из системы"),f.push("/")},loading:c},children:t})}function c(){let e=(0,n.useContext)(l);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},9116:function(e,t,r){"use strict";r.d(t,{PH:function(){return s},hi:function(){return i},zy:function(){return o}});var a=r(3464),n=r(257);let i=a.Z.create({baseURL:n.env.NEXT_PUBLIC_API_URL||"https://prokvartiru.kz/api",headers:{"Content-Type":"application/json"}});i.interceptors.request.use(e=>e,e=>Promise.reject(e)),i.interceptors.response.use(e=>e,e=>{var t;return(null===(t=e.response)||void 0===t?void 0:t.status)===401&&(window.location.href="/login"),Promise.reject(e)});let s={getRememberedAddresses:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,r=new URLSearchParams;return e&&r.append("city",e),r.append("limit",t.toString()),(await i.get("/addresses/remembered?".concat(r))).data},saveRememberedAddress:async e=>(await i.post("/addresses/remembered",e)).data,getPopularAddresses:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:20;return(await i.get("/addresses/popular?limit=".concat(e))).data},searchAddresses:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;return(await i.get("/addresses/search?q=".concat(encodeURIComponent(e),"&limit=").concat(t))).data}},o={getTrendingTopics:async()=>(await i.get("/recommendations/trending-topics")).data,getStats:async()=>(await i.get("/recommendations/stats")).data,getUserPreferences:async()=>(await i.get("/recommendations/user-preferences")).data}},4508:function(e,t,r){"use strict";r.d(t,{cn:function(){return i}});var a=r(1994),n=r(3335);function i(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,n.m6)((0,a.W)(t))}},6394:function(e,t,r){"use strict";r.d(t,{f:function(){return o}});var a=r(2265),n=r(6840),i=r(7437),s=a.forwardRef((e,t)=>(0,i.jsx)(n.WV.label,{...e,ref:t,onMouseDown:t=>{var r;t.target.closest("button, input, select, textarea")||(null===(r=e.onMouseDown)||void 0===r||r.call(e,t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));s.displayName="Label";var o=s}},function(e){e.O(0,[72,278,648,971,117,744],function(){return e(e.s=5391)}),_N_E=e.O()}]);