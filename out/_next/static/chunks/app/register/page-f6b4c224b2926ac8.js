(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[11],{220:function(e,t,r){Promise.resolve().then(r.bind(r,2833))},2833:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return v}});var a=r(7437),s=r(2265),n=r(7648),i=r(8730),o=r(2869),d=r(5186),l=r(6815),c=r(6070);let u=/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,m=/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[a-zA-Z\d@$!%*?&]{8,}$/,f=new RegExp("^[a-zA-Z".concat("\\u0400-\\u04FF\\u0500-\\u052F\\u2DE0-\\u2DFF\\uA640-\\uA69F","\\s\\-']{2,50}$")),p=e=>e.trim().toLowerCase(),h=e=>e.trim().replace(/\s+/g," ");function v(){let[e,t]=(0,s.useState)({email:"",password:"",firstName:"",lastName:""}),[r,v]=(0,s.useState)({}),[g,x]=(0,s.useState)(!1),{register:N}=(0,i.a)(),b=async t=>{t.preventDefault();let r={email:p(e.email),password:e.password,firstName:h(e.firstName),lastName:h(e.lastName)},a=function(e){let t={};return e.email&&""!==e.email.trim()?u.test(e.email)||(t.email="Введите корректный email"):t.email="Email обязателен",e.password&&""!==e.password.trim()?m.test(e.password)||(t.password="Пароль должен содержать минимум 8 символов, заглавные и строчные буквы и цифры"):t.password="Пароль обязателен",e.firstName&&""!==e.firstName.trim()?f.test(e.firstName)||(t.firstName="Имя может содержать только буквы, пробелы, дефисы и апострофы (2-50 символов)"):t.firstName="Имя обязательно",e.lastName&&""!==e.lastName.trim()?f.test(e.lastName)||(t.lastName="Фамилия может содержать только буквы, пробелы, дефисы и апострофы (2-50 символов)"):t.lastName="Фамилия обязательна",t}(r);if(Object.keys(a).length>0){v(a);return}v({}),x(!0);try{await N(r)}catch(e){}finally{x(!1)}},y=e=>{let{name:a,value:s}=e.target;t(e=>({...e,[a]:s})),r[a]&&v(e=>({...e,[a]:""}))};return(0,a.jsx)("div",{className:"max-w-md mx-auto mt-16",children:(0,a.jsxs)(c.Zb,{children:[(0,a.jsxs)(c.Ol,{children:[(0,a.jsx)(c.ll,{children:"Регистрация"}),(0,a.jsx)(c.SZ,{children:"Создайте аккаунт, чтобы начать оставлять отзывы"})]}),(0,a.jsxs)(c.aY,{children:[(0,a.jsxs)("form",{onSubmit:b,className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(l._,{htmlFor:"firstName",children:"Имя"}),(0,a.jsx)(d.I,{id:"firstName",name:"firstName",value:e.firstName,onChange:y,required:!0,className:r.firstName?"border-red-500":""}),r.firstName&&(0,a.jsx)("p",{className:"text-sm text-red-600",children:r.firstName})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(l._,{htmlFor:"lastName",children:"Фамилия"}),(0,a.jsx)(d.I,{id:"lastName",name:"lastName",value:e.lastName,onChange:y,required:!0,className:r.lastName?"border-red-500":""}),r.lastName&&(0,a.jsx)("p",{className:"text-sm text-red-600",children:r.lastName})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(l._,{htmlFor:"email",children:"Email"}),(0,a.jsx)(d.I,{id:"email",name:"email",type:"email",value:e.email,onChange:y,required:!0,className:r.email?"border-red-500":""}),r.email&&(0,a.jsx)("p",{className:"text-sm text-red-600",children:r.email})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(l._,{htmlFor:"password",children:"Пароль"}),(0,a.jsx)(d.I,{id:"password",name:"password",type:"password",value:e.password,onChange:y,required:!0,minLength:8,className:r.password?"border-red-500":""}),r.password&&(0,a.jsx)("p",{className:"text-sm text-red-600",children:r.password}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"Пароль должен содержать минимум 8 символов с заглавными буквами, строчными буквами и цифрами"})]}),(0,a.jsx)(o.z,{type:"submit",className:"w-full",disabled:g,children:g?"Создание аккаунта...":"Зарегистрироваться"})]}),(0,a.jsxs)("div",{className:"mt-4 text-center text-sm",children:["Уже есть аккаунт?"," ",(0,a.jsx)(n.default,{href:"/login",className:"text-blue-600 hover:underline",children:"Войти"})]})]})]})})}},2869:function(e,t,r){"use strict";r.d(t,{z:function(){return l}});var a=r(7437),s=r(2265),n=r(7053),i=r(535),o=r(4508);let d=(0,i.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),l=s.forwardRef((e,t)=>{let{className:r,variant:s,size:i,asChild:l=!1,...c}=e,u=l?n.g7:"button";return(0,a.jsx)(u,{className:(0,o.cn)(d({variant:s,size:i,className:r})),ref:t,...c})});l.displayName="Button"},6070:function(e,t,r){"use strict";r.d(t,{Ol:function(){return o},SZ:function(){return l},Zb:function(){return i},aY:function(){return c},ll:function(){return d}});var a=r(7437),s=r(2265),n=r(4508);let i=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",r),...s})});i.displayName="Card";let o=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",r),...s})});o.displayName="CardHeader";let d=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",r),...s})});d.displayName="CardTitle";let l=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",r),...s})});l.displayName="CardDescription";let c=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("p-6 pt-0",r),...s})});c.displayName="CardContent",s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("flex items-center p-6 pt-0",r),...s})}).displayName="CardFooter"},5186:function(e,t,r){"use strict";r.d(t,{I:function(){return i}});var a=r(7437),s=r(2265),n=r(4508);let i=s.forwardRef((e,t)=>{let{className:r,type:s,error:i,...o}=e;return(0,a.jsx)("input",{type:s,className:(0,n.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",i&&"border-red-500 focus-visible:ring-red-500",r),ref:t,...o})});i.displayName="Input"},6815:function(e,t,r){"use strict";r.d(t,{_:function(){return l}});var a=r(7437),s=r(2265),n=r(6394),i=r(535),o=r(4508);let d=(0,i.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),l=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(n.f,{ref:t,className:(0,o.cn)(d(),r),...s})});l.displayName=n.f.displayName},8730:function(e,t,r){"use strict";r.d(t,{H:function(){return c},a:function(){return u}});var a=r(7437),s=r(2265),n=r(9376),i=r(4131),o=r(9116),d=r(9064);let l=(0,s.createContext)(void 0);function c(e){let{children:t}=e,[r,c]=(0,s.useState)(null),[u,m]=(0,s.useState)(!0),f=(0,n.useRouter)();(0,s.useEffect)(()=>{let e=i.Z.get("token");e?(o.hi.defaults.headers.common.Authorization="Bearer ".concat(e),p()):m(!1)},[]);let p=async()=>{try{let e=await o.hi.get("/auth/me");c(e.data.user)}catch(e){i.Z.remove("token"),delete o.hi.defaults.headers.common.Authorization}finally{m(!1)}},h=async(e,t)=>{try{let{token:r,user:a}=(await o.hi.post("/auth/login",{email:e,password:t})).data;i.Z.set("token",r,{expires:7}),o.hi.defaults.headers.common.Authorization="Bearer ".concat(r),c(a),d.ZP.success("Вход выполнен успешно!"),f.push("/dashboard")}catch(e){var r,a;throw d.ZP.error((null===(a=e.response)||void 0===a?void 0:null===(r=a.data)||void 0===r?void 0:r.message)||"Ошибка входа"),e}},v=async e=>{try{let{user:t}=(await o.hi.post("/auth/register",e)).data;d.ZP.success("Код подтверждения отправлен на ваш email. Пожалуйста, введите его для завершения регистрации."),f.push("/verify-email/verify?email=".concat(encodeURIComponent(t.email)))}catch(e){var t,r;throw d.ZP.error((null===(r=e.response)||void 0===r?void 0:null===(t=r.data)||void 0===t?void 0:t.message)||"Ошибка регистрации"),e}},g=async(e,t)=>{try{await o.hi.post("/auth/verify-email",{email:e,code:t}),d.ZP.success("Email успешно подтвержден!"),r?await p():f.push("/login")}catch(e){var a,s;throw d.ZP.error((null===(s=e.response)||void 0===s?void 0:null===(a=s.data)||void 0===a?void 0:a.message)||"Ошибка подтверждения email"),e}};return(0,a.jsx)(l.Provider,{value:{user:r,login:h,register:v,verifyEmail:g,logout:()=>{i.Z.remove("token"),delete o.hi.defaults.headers.common.Authorization,c(null),d.ZP.success("Вы успешно вышли из системы"),f.push("/")},loading:u},children:t})}function u(){let e=(0,s.useContext)(l);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},9116:function(e,t,r){"use strict";r.d(t,{PH:function(){return i},hi:function(){return n},zy:function(){return o}});var a=r(3464),s=r(257);let n=a.Z.create({baseURL:s.env.NEXT_PUBLIC_API_URL||"http://localhost:4100/api",headers:{"Content-Type":"application/json"}});n.interceptors.request.use(e=>e,e=>Promise.reject(e)),n.interceptors.response.use(e=>e,e=>{var t;return(null===(t=e.response)||void 0===t?void 0:t.status)===401&&(window.location.href="/login"),Promise.reject(e)});let i={getRememberedAddresses:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,r=new URLSearchParams;return e&&r.append("city",e),r.append("limit",t.toString()),(await n.get("/addresses/remembered?".concat(r))).data},saveRememberedAddress:async e=>(await n.post("/addresses/remembered",e)).data,getPopularAddresses:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:20;return(await n.get("/addresses/popular?limit=".concat(e))).data},searchAddresses:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;return(await n.get("/addresses/search?q=".concat(encodeURIComponent(e),"&limit=").concat(t))).data}},o={getTrendingTopics:async()=>(await n.get("/recommendations/trending-topics")).data,getStats:async()=>(await n.get("/recommendations/stats")).data,getUserPreferences:async()=>(await n.get("/recommendations/user-preferences")).data}},4508:function(e,t,r){"use strict";r.d(t,{cn:function(){return n}});var a=r(1994),s=r(3335);function n(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,s.m6)((0,a.W)(t))}},6394:function(e,t,r){"use strict";r.d(t,{f:function(){return o}});var a=r(2265),s=r(6840),n=r(7437),i=a.forwardRef((e,t)=>(0,n.jsx)(s.WV.label,{...e,ref:t,onMouseDown:t=>{var r;t.target.closest("button, input, select, textarea")||(null===(r=e.onMouseDown)||void 0===r||r.call(e,t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));i.displayName="Label";var o=i}},function(e){e.O(0,[72,278,648,971,117,744],function(){return e(e.s=220)}),_N_E=e.O()}]);